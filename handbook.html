<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Zeppe-Lin Handbook</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" href="https://github.com/zeppe-lin/artwork/blob/master/favicon.png?raw=true" sizes="192x192">
<!--
    <style type="text/css">
  html { -webkit-text-size-adjust: 100%; }
  pre > code.sourceCode { white-space: pre; position: relative; }
  pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
  pre > code.sourceCode > span:empty { height: 1.2em; }
  .sourceCode { overflow: visible; }
  code.sourceCode > span { color: inherit; text-decoration: inherit; }
  div.sourceCode { margin: 1em 0; }
  pre.sourceCode { margin: 0; }
  @media screen {
  div.sourceCode { overflow: auto; }
  }
  @media print {
  pre > code.sourceCode { white-space: pre-wrap; }
  pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
  }
  pre.numberSource code
    { counter-reset: source-line 0; }
  pre.numberSource code > span
    { position: relative; left: -4em; counter-increment: source-line; }
  pre.numberSource code > span > a:first-child::before
    { content: counter(source-line);
      position: relative; left: -1em; text-align: right; vertical-align: baseline;
      border: none; display: inline-block;
      -webkit-touch-callout: none; -webkit-user-select: none;
      -khtml-user-select: none; -moz-user-select: none;
      -ms-user-select: none; user-select: none;
      padding: 0 4px; width: 4em;
    }
  pre.numberSource { margin-left: 3em;  padding-left: 4px; }
  div.sourceCode
    { color: #cccccc; background-color: #303030; }
  @media screen {
  pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
  }
  code span.al { color: #ffcfaf; } /* Alert */
  code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
  code span.at { } /* Attribute */
  code span.bn { color: #dca3a3; } /* BaseN */
  code span.bu { } /* BuiltIn */
  code span.cf { color: #f0dfaf; } /* ControlFlow */
  code span.ch { color: #dca3a3; } /* Char */
  code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
  code span.co { color: #7f9f7f; } /* Comment */
  code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
  code span.do { color: #7f9f7f; } /* Documentation */
  code span.dt { color: #dfdfbf; } /* DataType */
  code span.dv { color: #dcdccc; } /* DecVal */
  code span.er { color: #c3bf9f; } /* Error */
  code span.ex { } /* Extension */
  code span.fl { color: #c0bed1; } /* Float */
  code span.fu { color: #efef8f; } /* Function */
  code span.im { } /* Import */
  code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
  code span.kw { color: #f0dfaf; } /* Keyword */
  code span.op { color: #f0efd0; } /* Operator */
  code span.ot { color: #efef8f; } /* Other */
  code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
  code span.sc { color: #dca3a3; } /* SpecialChar */
  code span.ss { color: #cc9393; } /* SpecialString */
  code span.st { color: #cc9393; } /* String */
  code span.va { } /* Variable */
  code span.vs { color: #cc9393; } /* VerbatimString */
  code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
  </style>
  -->
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/tango.css"
  media="(prefers-color-scheme: light)">
  <link rel="stylesheet" href="css/zenburn.css"
  media="(prefers-color-scheme: dark)">
</head>
<body class="has-toc">

<nav id="TOC" role="doc-toc">
  <div class="toc-title">Contents</div>
  <ul>
  <li><a href="#preface" id="toc-preface">PREFACE</a></li>
  <li><a href="#introduction" id="toc-introduction"><span
  class="toc-section-number">1</span> INTRODUCTION</a>
  <ul>
  <li><a href="#about-zeppe-lin" id="toc-about-zeppe-lin"><span
  class="toc-section-number">1.1</span> About Zeppe-Lin</a></li>
  <li><a href="#audience" id="toc-audience"><span
  class="toc-section-number">1.2</span> Audience</a></li>
  <li><a href="#summary" id="toc-summary"><span
  class="toc-section-number">1.3</span> Summary</a></li>
  </ul></li>
  <li><a href="#installation" id="toc-installation"><span
  class="toc-section-number">2</span> INSTALLATION</a>
  <ul>
  <li><a href="#supported-hardware" id="toc-supported-hardware"><span
  class="toc-section-number">2.1</span> Supported Hardware</a></li>
  <li><a href="#boot-a-live-system" id="toc-boot-a-live-system"><span
  class="toc-section-number">2.2</span> Boot a Live System</a></li>
  <li><a href="#disk-partitions-and-filesystems"
  id="toc-disk-partitions-and-filesystems"><span
  class="toc-section-number">2.3</span> Disk Partitions and
  Filesystems</a>
  <ul>
  <li><a href="#uefi-and-lvm-on-luks"
  id="toc-uefi-and-lvm-on-luks"><span
  class="toc-section-number">2.3.1</span> UEFI and LVM on LUKS</a></li>
  </ul></li>
  <li><a href="#install-base-system" id="toc-install-base-system"><span
  class="toc-section-number">2.4</span> Install Base System</a>
  <ul>
  <li><a href="#download-rootfs-tarball"
  id="toc-download-rootfs-tarball"><span
  class="toc-section-number">2.4.1</span> Download Rootfs
  Tarball</a></li>
  <li><a href="#verify-downloaded-tarball"
  id="toc-verify-downloaded-tarball"><span
  class="toc-section-number">2.4.2</span> Verify Downloaded
  Tarball</a></li>
  <li><a href="#extract-rootfs-tarball"
  id="toc-extract-rootfs-tarball"><span
  class="toc-section-number">2.4.3</span> Extract Rootfs
  Tarball</a></li>
  </ul></li>
  <li><a href="#chroot-into-base-system"
  id="toc-chroot-into-base-system"><span
  class="toc-section-number">2.5</span> Chroot Into Base System</a></li>
  <li><a href="#configure-base-system"
  id="toc-configure-base-system"><span
  class="toc-section-number">2.6</span> Configure Base System</a>
  <ul>
  <li><a href="#mount-additional-filesystems"
  id="toc-mount-additional-filesystems"><span
  class="toc-section-number">2.6.1</span> Mount Additional
  Filesystems</a></li>
  <li><a href="#configure-users-and-privileges"
  id="toc-configure-users-and-privileges"><span
  class="toc-section-number">2.6.2</span> Configure Users and
  Privileges</a></li>
  </ul></li>
  <li><a href="#update-the-base-system"
  id="toc-update-the-base-system"><span
  class="toc-section-number">2.7</span> Update the Base System</a>
  <ul>
  <li><a href="#prepare-pkgsrc-collections"
  id="toc-prepare-pkgsrc-collections"><span
  class="toc-section-number">2.7.1</span> Prepare Pkgsrc
  Collections</a></li>
  <li><a href="#perform-the-system-update"
  id="toc-perform-the-system-update"><span
  class="toc-section-number">2.7.2</span> Perform the System
  Update</a></li>
  </ul></li>
  <li><a href="#install-essential-packages"
  id="toc-install-essential-packages"><span
  class="toc-section-number">2.8</span> Install Essential
  Packages</a></li>
  <li><a href="#kernel-setup" id="toc-kernel-setup"><span
  class="toc-section-number">2.9</span> Kernel Setup</a>
  <ul>
  <li><a href="#kernel-package" id="toc-kernel-package"><span
  class="toc-section-number">2.9.1</span> Kernel Package</a></li>
  <li><a href="#manual-kernel-compilation"
  id="toc-manual-kernel-compilation"><span
  class="toc-section-number">2.9.2</span> Manual Kernel
  Compilation</a></li>
  </ul></li>
  <li><a href="#kernel-firmware" id="toc-kernel-firmware"><span
  class="toc-section-number">2.10</span> Kernel Firmware</a></li>
  <li><a href="#initramfs" id="toc-initramfs"><span
  class="toc-section-number">2.11</span> Initramfs</a></li>
  <li><a href="#bootloader" id="toc-bootloader"><span
  class="toc-section-number">2.12</span> Bootloader</a>
  <ul>
  <li><a href="#grub2" id="toc-grub2"><span
  class="toc-section-number">2.12.1</span> GRUB2</a></li>
  </ul></li>
  <li><a href="#post-installation-tasks"
  id="toc-post-installation-tasks"><span
  class="toc-section-number">2.13</span> Post-installation Tasks</a>
  <ul>
  <li><a href="#install-xorg-and-drivers"
  id="toc-install-xorg-and-drivers"><span
  class="toc-section-number">2.13.1</span> Install Xorg and
  Drivers</a></li>
  <li><a href="#install-a-window-manager"
  id="toc-install-a-window-manager"><span
  class="toc-section-number">2.13.2</span> Install a Window
  Manager</a></li>
  </ul></li>
  <li><a href="#reboot" id="toc-reboot"><span
  class="toc-section-number">2.14</span> Reboot</a></li>
  </ul></li>
  <li><a href="#upgrading" id="toc-upgrading"><span
  class="toc-section-number">3</span> UPGRADING</a>
  <ul>
  <li><a href="#release-notes" id="toc-release-notes"><span
  class="toc-section-number">3.1</span> Release Notes</a></li>
  <li><a href="#set-release-and-sync"
  id="toc-set-release-and-sync"><span
  class="toc-section-number">3.2</span> Set Release And Sync</a>
  <ul>
  <li><a href="#binary-upgrade" id="toc-binary-upgrade"><span
  class="toc-section-number">3.2.1</span> Binary Upgrade</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#package-management" id="toc-package-management"><span
  class="toc-section-number">4</span> PACKAGE MANAGEMENT</a>
  <ul>
  <li><a href="#introduction-1" id="toc-introduction-1"><span
  class="toc-section-number">4.1</span> Introduction</a></li>
  <li><a href="#what-is-a-package" id="toc-what-is-a-package"><span
  class="toc-section-number">4.2</span> What is a Package?</a>
  <ul>
  <li><a href="#package-naming" id="toc-package-naming"><span
  class="toc-section-number">4.2.1</span> Package Naming</a></li>
  <li><a href="#package-database" id="toc-package-database"><span
  class="toc-section-number">4.2.2</span> Package Database</a></li>
  </ul></li>
  <li><a href="#low-level-tools-pkgutils"
  id="toc-low-level-tools-pkgutils"><span
  class="toc-section-number">4.3</span> Low-level Tools: pkgutils</a>
  <ul>
  <li><a href="#using-pkgutils" id="toc-using-pkgutils"><span
  class="toc-section-number">4.3.1</span> Using pkgutils</a></li>
  <li><a href="#configuring-pkgadd" id="toc-configuring-pkgadd"><span
  class="toc-section-number">4.3.2</span> Configuring pkgadd</a></li>
  </ul></li>
  <li><a href="#low-level-tools-rejmerge"
  id="toc-low-level-tools-rejmerge"><span
  class="toc-section-number">4.4</span> Low-level Tools: rejmerge</a>
  <ul>
  <li><a href="#using-rejmerge" id="toc-using-rejmerge"><span
  class="toc-section-number">4.4.1</span> Using rejmerge</a></li>
  <li><a href="#configuring-rejmerge"
  id="toc-configuring-rejmerge"><span
  class="toc-section-number">4.4.2</span> Configuring rejmerge</a></li>
  </ul></li>
  <li><a href="#low-level-tools-pkgmk"
  id="toc-low-level-tools-pkgmk"><span
  class="toc-section-number">4.5</span> Low-level Tools: pkgmk</a>
  <ul>
  <li><a href="#pkgfile-format" id="toc-pkgfile-format"><span
  class="toc-section-number">4.5.1</span> Pkgfile Format</a></li>
  <li><a href="#using-pkgmk" id="toc-using-pkgmk"><span
  class="toc-section-number">4.5.2</span> Using pkgmk</a></li>
  <li><a href="#configuring-pkgmk" id="toc-configuring-pkgmk"><span
  class="toc-section-number">4.5.3</span> Configuring pkgmk</a></li>
  </ul></li>
  <li><a href="#high-level-tool-pkgman"
  id="toc-high-level-tool-pkgman"><span
  class="toc-section-number">4.6</span> High-level Tool: pkgman</a>
  <ul>
  <li><a href="#using-pkgman" id="toc-using-pkgman"><span
  class="toc-section-number">4.6.1</span> Using pkgman</a></li>
  <li><a href="#configuring-pkgman" id="toc-configuring-pkgman"><span
  class="toc-section-number">4.6.2</span> Configuring pkgman</a></li>
  </ul></li>
  <li><a href="#the-essentials-outro"
  id="toc-the-essentials-outro"><span
  class="toc-section-number">4.7</span> The Essentials (outro)</a></li>
  </ul></li>
  <li><a href="#package-sources-and-collections"
  id="toc-package-sources-and-collections"><span
  class="toc-section-number">5</span> PACKAGE SOURCES AND
  COLLECTIONS</a>
  <ul>
  <li><a href="#introduction-2" id="toc-introduction-2"><span
  class="toc-section-number">5.1</span> Introduction</a></li>
  <li><a href="#organizing-package-sources"
  id="toc-organizing-package-sources"><span
  class="toc-section-number">5.2</span> Organizing Package Sources</a>
  <ul>
  <li><a href="#package-source-the-core-unit"
  id="toc-package-source-the-core-unit"><span
  class="toc-section-number">5.2.1</span> Package Source: The Core
  Unit</a></li>
  <li><a href="#collections" id="toc-collections"><span
  class="toc-section-number">5.2.2</span> Collections</a></li>
  <li><a href="#repositories-distributing-and-versioning-collections"
  id="toc-repositories-distributing-and-versioning-collections"><span
  class="toc-section-number">5.2.3</span> Repositories: Distributing and
  Versioning Collections</a></li>
  </ul></li>
  <li><a href="#managing-package-sources"
  id="toc-managing-package-sources"><span
  class="toc-section-number">5.3</span> Managing Package Sources</a>
  <ul>
  <li><a href="#setting-up-collections"
  id="toc-setting-up-collections"><span
  class="toc-section-number">5.3.1</span> Setting Up
  Collections</a></li>
  <li><a href="#exploring-and-installing-packages"
  id="toc-exploring-and-installing-packages"><span
  class="toc-section-number">5.3.2</span> Exploring and Installing
  Packages</a></li>
  <li><a href="#keeping-your-system-up-to-date"
  id="toc-keeping-your-system-up-to-date"><span
  class="toc-section-number">5.3.3</span> Keeping Your System
  Up-to-Date</a></li>
  <li><a href="#advanced-package-management"
  id="toc-advanced-package-management"><span
  class="toc-section-number">5.3.4</span> Advanced Package
  Management</a></li>
  </ul></li>
  <li><a href="#extending-software-sources"
  id="toc-extending-software-sources"><span
  class="toc-section-number">5.4</span> Extending Software Sources</a>
  <ul>
  <li><a href="#adding-a-local-collection"
  id="toc-adding-a-local-collection"><span
  class="toc-section-number">5.4.1</span> Adding a Local
  Collection</a></li>
  <li><a href="#creating-custom-packages"
  id="toc-creating-custom-packages"><span
  class="toc-section-number">5.4.2</span> Creating Custom
  Packages</a></li>
  <li><a href="#building-and-installing-custom-packages"
  id="toc-building-and-installing-custom-packages"><span
  class="toc-section-number">5.4.3</span> Building and Installing Custom
  Packages</a></li>
  <li><a href="#building-packages-from-bleeding-edge-sources"
  id="toc-building-packages-from-bleeding-edge-sources"><span
  class="toc-section-number">5.4.4</span> Building Packages from
  Bleeding-Edge Sources</a></li>
  </ul></li>
  <li><a href="#tips-and-best-practices"
  id="toc-tips-and-best-practices"><span
  class="toc-section-number">5.5</span> Tips and Best Practices</a>
  <ul>
  <li><a href="#renicing-builds" id="toc-renicing-builds"><span
  class="toc-section-number">5.5.1</span> Renicing Builds</a></li>
  <li><a href="#ram-builds-for-faster-package-compilation"
  id="toc-ram-builds-for-faster-package-compilation"><span
  class="toc-section-number">5.5.2</span> RAM Builds for Faster Package
  Compilation</a></li>
  <li><a href="#unprivileged-builds-in-zeppe-lin"
  id="toc-unprivileged-builds-in-zeppe-lin"><span
  class="toc-section-number">5.5.3</span> Unprivileged Builds in
  Zeppe-Lin</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#configuration" id="toc-configuration"><span
  class="toc-section-number">6</span> CONFIGURATION</a>
  <ul>
  <li><a href="#generating-locales" id="toc-generating-locales"><span
  class="toc-section-number">6.1</span> Generating Locales</a></li>
  <li><a href="#system-initialization-and-configuration"
  id="toc-system-initialization-and-configuration"><span
  class="toc-section-number">6.2</span> System Initialization and
  Configuration</a>
  <ul>
  <li><a href="#system-states-runlevels"
  id="toc-system-states-runlevels"><span
  class="toc-section-number">6.2.1</span> System States
  (Runlevels)</a></li>
  <li><a href="#core-init-scripts" id="toc-core-init-scripts"><span
  class="toc-section-number">6.2.2</span> Core Init Scripts</a></li>
  <li><a href="#configuring-runlevels-and-init-behavior"
  id="toc-configuring-runlevels-and-init-behavior"><span
  class="toc-section-number">6.2.3</span> Configuring Runlevels and Init
  Behavior</a></li>
  <li><a href="#configuring-system-behavior-etcrc.conf"
  id="toc-configuring-system-behavior-etcrc.conf"><span
  class="toc-section-number">6.2.4</span> Configuring System Behavior
  (/etc/rc.conf)</a></li>
  <li><a href="#service-control-scripts-etcrc.d"
  id="toc-service-control-scripts-etcrc.d"><span
  class="toc-section-number">6.2.5</span> Service Control Scripts
  (/etc/rc.d/)</a></li>
  <li><a href="#kernel-module-management-etcrc.modules"
  id="toc-kernel-module-management-etcrc.modules"><span
  class="toc-section-number">6.2.6</span> Kernel Module Management
  (/etc/rc.modules)</a></li>
  <li><a href="#custom-startup-commands-etcrc.local"
  id="toc-custom-startup-commands-etcrc.local"><span
  class="toc-section-number">6.2.7</span> Custom Startup Commands
  (/etc/rc.local)</a></li>
  <li><a href="#from-boot-to-login-system-startup-sequence"
  id="toc-from-boot-to-login-system-startup-sequence"><span
  class="toc-section-number">6.2.8</span> From Boot to Login: System
  Startup Sequence</a></li>
  <li><a href="#minimal-mode-single-user-mode"
  id="toc-minimal-mode-single-user-mode"><span
  class="toc-section-number">6.2.9</span> Minimal Mode (Single-User
  Mode)</a></li>
  <li><a href="#graceful-shutdown-procedure"
  id="toc-graceful-shutdown-procedure"><span
  class="toc-section-number">6.2.10</span> Graceful Shutdown
  Procedure</a></li>
  </ul></li>
  <li><a href="#networking" id="toc-networking"><span
  class="toc-section-number">6.3</span> Networking</a>
  <ul>
  <li><a href="#hostname-configuration"
  id="toc-hostname-configuration"><span
  class="toc-section-number">6.3.1</span> Hostname
  Configuration</a></li>
  <li><a href="#static-address" id="toc-static-address"><span
  class="toc-section-number">6.3.2</span> Static Address</a></li>
  <li><a href="#dynamic-address" id="toc-dynamic-address"><span
  class="toc-section-number">6.3.3</span> Dynamic Address</a></li>
  <li><a href="#wireless-network" id="toc-wireless-network"><span
  class="toc-section-number">6.3.4</span> Wireless Network</a></li>
  <li><a href="#bridge-networking" id="toc-bridge-networking"><span
  class="toc-section-number">6.3.5</span> Bridge Networking</a></li>
  </ul></li>
  <li><a href="#time-and-date-configuration"
  id="toc-time-and-date-configuration"><span
  class="toc-section-number">6.4</span> Time and Date Configuration</a>
  <ul>
  <li><a href="#timezone-setup" id="toc-timezone-setup"><span
  class="toc-section-number">6.4.1</span> Timezone Setup</a></li>
  <li><a href="#system-clock-setup" id="toc-system-clock-setup"><span
  class="toc-section-number">6.4.2</span> System Clock Setup</a></li>
  <li><a href="#network-time-protocol-ntp-configuration"
  id="toc-network-time-protocol-ntp-configuration"><span
  class="toc-section-number">6.4.3</span> Network Time Protocol (NTP)
  Configuration</a></li>
  </ul></li>
  <li><a href="#user-authentication-and-environment"
  id="toc-user-authentication-and-environment"><span
  class="toc-section-number">6.5</span> User Authentication and
  Environment</a>
  <ul>
  <li><a href="#password-management" id="toc-password-management"><span
  class="toc-section-number">6.5.1</span> Password Management</a></li>
  <li><a href="#user-environment" id="toc-user-environment"><span
  class="toc-section-number">6.5.2</span> User Environment</a></li>
  <li><a href="#pluggable-authentication-modules-pam"
  id="toc-pluggable-authentication-modules-pam"><span
  class="toc-section-number">6.5.3</span> Pluggable Authentication
  Modules (PAM)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#appendices" id="toc-appendices"><span
  class="toc-section-number">7</span> APPENDICES</a>
  <ul>
  <li><a href="#appendix-a-licensing-legal"
  id="toc-appendix-a-licensing-legal"><span
  class="toc-section-number">7.1</span> Appendix A: Licensing &amp;
  Legal</a>
  <ul>
  <li><a href="#software-packages" id="toc-software-packages"><span
  class="toc-section-number">7.1.1</span> Software &amp;
  Packages</a></li>
  <li><a href="#build-scripts" id="toc-build-scripts"><span
  class="toc-section-number">7.1.2</span> Build Scripts</a></li>
  <li><a href="#website-artwork" id="toc-website-artwork"><span
  class="toc-section-number">7.1.3</span> Website &amp; Artwork</a></li>
  <li><a href="#disclaimer" id="toc-disclaimer"><span
  class="toc-section-number">7.1.4</span> Disclaimer</a></li>
  </ul></li>
  <li><a href="#appendix-b-troubleshooting"
  id="toc-appendix-b-troubleshooting"><span
  class="toc-section-number">7.2</span> Appendix B: Troubleshooting</a>
  <ul>
  <li><a href="#dhcpcd-networking-issues"
  id="toc-dhcpcd-networking-issues"><span
  class="toc-section-number">7.2.1</span> dhcpcd Networking
  Issues</a></li>
  </ul></li>
  <li><a href="#appendix-c-frequently-asked-questions"
  id="toc-appendix-c-frequently-asked-questions"><span
  class="toc-section-number">7.3</span> Appendix C: Frequently Asked
  Questions</a>
  <ul>
  <li><a href="#general" id="toc-general"><span
  class="toc-section-number">7.3.1</span> General</a></li>
  <li><a href="#installation-1" id="toc-installation-1"><span
  class="toc-section-number">7.3.2</span> Installation</a></li>
  <li><a href="#configuration-1" id="toc-configuration-1"><span
  class="toc-section-number">7.3.3</span> Configuration</a></li>
  <li><a href="#packages-and-features"
  id="toc-packages-and-features"><span
  class="toc-section-number">7.3.4</span> Packages and Features</a></li>
  <li><a href="#maintenance" id="toc-maintenance"><span
  class="toc-section-number">7.3.5</span> Maintenance</a></li>
  <li><a href="#support-and-community"
  id="toc-support-and-community"><span
  class="toc-section-number">7.3.6</span> Support and Community</a></li>
  <li><a href="#philosophy" id="toc-philosophy"><span
  class="toc-section-number">7.3.7</span> Philosophy</a></li>
  </ul></li>
  <li><a href="#appendix-d-reporting-issues"
  id="toc-appendix-d-reporting-issues"><span
  class="toc-section-number">7.4</span> Appendix D: Reporting Issues</a>
  <ul>
  <li><a href="#where-to-report" id="toc-where-to-report"><span
  class="toc-section-number">7.4.1</span> Where to Report</a></li>
  <li><a href="#what-to-include" id="toc-what-to-include"><span
  class="toc-section-number">7.4.2</span> What to Include</a></li>
  <li><a href="#reporting-guidelines"
  id="toc-reporting-guidelines"><span
  class="toc-section-number">7.4.3</span> Reporting Guidelines</a></li>
  </ul></li>
  </ul></li>
  </ul>
  </div>
</nav>

<main>
  <p><a href="index.html">Back to Index</a></p>
  <h1 class="unnumbered" id="preface">PREFACE</h1>
  <p>Zeppe-Lin Handbook.<br />
  <em>Because figuring it out yourself is overrated.</em></p>
  <p>This guide provides everything you need to install, configure, and
  maintain your Zeppe-Lin system.</p>
  <p>Build the system you need. This handbook shows you how.<br />
  <em>Because nobody else will.</em></p>
  <hr />
  <h1 data-number="1" id="introduction"><span
  class="header-section-number">1</span> INTRODUCTION</h1>
  <h2 data-number="1.1" id="about-zeppe-lin"><span
  class="header-section-number">1.1</span> About Zeppe-Lin</h2>
  <p>Zeppe‑Lin is a lightweight, source‑based GNU/Linux distribution for
  x86‑64 systems. A fork of CRUX, it emphasizes simplicity,
  predictability, and maintainable design. It follows UNIX principles:
  small tools, plain‑text configuration, and explicit behavior.
  Automation is minimal and visible.</p>
  <p>Zeppe‑Lin is designed for users who want full control over their
  system. Everything can be built, inspected, and maintained from
  source, ensuring autonomy, transparency, and reproducibility. The
  system favors practical, reliable behavior over cleverness or
  unnecessary features.</p>
  <h2 data-number="1.2" id="audience"><span
  class="header-section-number">1.2</span> Audience</h2>
  <p>Zeppe‑Lin suits users who:</p>
  <ul>
  <li>Prefer a minimal and predictable environment</li>
  <li>Manage and configure the system via text files</li>
  <li>Build software from source to control dependencies</li>
  <li>Want to fully understand and maintain their system</li>
  </ul>
  <h2 data-number="1.3" id="summary"><span
  class="header-section-number">1.3</span> Summary</h2>
  <p>By keeping components small, behavior explicit, and operations
  visible, Zeppe‑Lin ensures the system is comprehensible, controllable,
  and practical, while remaining flexible enough to adapt to individual
  needs.</p>
  <hr />
  <h1 data-number="2" id="installation"><span
  class="header-section-number">2</span> INSTALLATION</h1>
  <h2 data-number="2.1" id="supported-hardware"><span
  class="header-section-number">2.1</span> Supported Hardware</h2>
  <p>Zeppe-Lin Linux supports <strong>x86-64</strong> processors (e.g.,
  AMD Athlon 64, Intel Core, Intel Atom). Older architectures, such as
  i686, are <strong>incompatible</strong>.</p>
  <h2 data-number="2.2" id="boot-a-live-system"><span
  class="header-section-number">2.2</span> Boot a Live System</h2>
  <p>Zeppe-Lin is distributed as a compiled tarball containing a root
  filesystem. To install it, first boot your computer using a
  Linux-based “Live CD/DVD/USB” system.</p>
  <p>Launch your preferred Live system, open a terminal, and gain root
  privileges (e.g., <code>sudo su</code>).</p>
  <h2 data-number="2.3" id="disk-partitions-and-filesystems"><span
  class="header-section-number">2.3</span> Disk Partitions and
  Filesystems</h2>
  <p>This section describes “UEFI and LVM on LUKS” installation.
  Additional partitions/filesystems schemes may be added in the
  future.</p>
  <h3 data-number="2.3.1" id="uefi-and-lvm-on-luks"><span
  class="header-section-number">2.3.1</span> UEFI and LVM on LUKS</h3>
  <p>Set up Zeppe-Lin on a fully encrypted disk (excluding the
  bootloader partition for UEFI compatibility) using
  <code>dm-crypt</code> with LUKS and an LVM container inside the
  encrypted partition.</p>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>Ensure the following tools are available in the Live system:</p>
  <ul>
  <li><code>parted</code> - Create and manage partitions.</li>
  <li><code>dosfstools</code> - Format the boot partition as FAT32
  (UEFI).</li>
  <li><code>cryptsetup</code> - Encrypt partition with LUKS.</li>
  <li><code>lvm2</code> - Manage logical volumes inside LUKS.</li>
  </ul>
  </blockquote>
  <h4 data-number="2.3.1.1" id="partition-scheme"><span
  class="header-section-number">2.3.1.1</span> Partition Scheme</h4>
  <p>Example device: <code>/dev/sda</code>. Replace with your actual
  device (e.g., <code>/dev/sdb</code>, <code>/dev/nvme0n1</code>).</p>
  <table>
  <thead>
  <tr>
  <th>Partition</th>
  <th>Filesystem</th>
  <th>Size</th>
  <th>Description</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td>/dev/sda1</td>
  <td>FAT32</td>
  <td>512 MiB</td>
  <td>boot partition</td>
  </tr>
  <tr>
  <td>/dev/sda2</td>
  <td>none</td>
  <td>remaining space</td>
  <td>LUKS container</td>
  </tr>
  </tbody>
  </table>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>On UEFI systems, the boot partition must be an <strong>EFI System
  Partition (ESP)</strong>.</p>
  <p>A size of <strong>512 MiB</strong> is recommended.</p>
  </blockquote>
  <h4 data-number="2.3.1.2" id="create-partitions"><span
  class="header-section-number">2.3.1.2</span> Create Partitions</h4>
  <p>Use <code>parted(8)</code> to partition the disk:</p>
  <div class="sourceCode" id="cb1"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">parted</span> <span class="at">-s</span> /dev/sda <span class="op">&lt;&lt;&#39;EOF&#39;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="st">mklabel gpt</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="st">mkpart ESP fat32 1MiB 513MiB</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">set 1 boot on</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="st">name 1 efiboot</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">mkpart primary 513MiB 100%</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">name 2 luks</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="st">quit</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span></code></pre></div>
  <p>Encrypt <code>/dev/sda2</code> with LUKS and map it:</p>
  <div class="sourceCode" id="cb2"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cryptsetup</span> luksFormat /dev/sda2</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">cryptsetup</span> luksOpen /dev/sda2 crypt</span></code></pre></div>
  <h4 data-number="2.3.1.3" id="create-lvm-inside-luks"><span
  class="header-section-number">2.3.1.3</span> Create LVM Inside
  LUKS</h4>
  <p>Create a physical volume and volume group (e.g.,
  <code>zpln</code>):</p>
  <div class="sourceCode" id="cb3"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pvcreate</span> /dev/mapper/crypt</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="ex">vgcreate</span> zpln /dev/mapper/crypt</span></code></pre></div>
  <p>Logical volume layout:</p>
  <table>
  <thead>
  <tr>
  <th>Volume name</th>
  <th>Filesystem</th>
  <th style="text-align: left;">Size</th>
  <th style="text-align: left;">Description</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td>swap</td>
  <td>none</td>
  <td style="text-align: left;">2 x RAM</td>
  <td style="text-align: left;">swap area</td>
  </tr>
  <tr>
  <td>root</td>
  <td>ext4</td>
  <td style="text-align: left;">remaining space</td>
  <td style="text-align: left;">root filesystem</td>
  </tr>
  </tbody>
  </table>
  <p>Check RAM size with <code># free -m</code>. For example, if you
  have 4 GiB RAM, a swap of 8 GiB (2 x RAM) is recommended.</p>
  <p>Create the logical volumes:</p>
  <div class="sourceCode" id="cb4"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">lvcreate</span> <span class="at">-L</span> 8G <span class="at">-n</span> swap zpln</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ex">lvcreate</span> <span class="at">-l</span> 100%FREE <span class="at">-n</span> root zpln</span></code></pre></div>
  <h4 data-number="2.3.1.4" id="create-filesystems-and-swap"><span
  class="header-section-number">2.3.1.4</span> Create Filesystems and
  Swap</h4>
  <p>Format partitions and volumes:</p>
  <div class="sourceCode" id="cb5"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">mkfs.vfat</span> <span class="at">-F32</span> /dev/sda1</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="ex">mkfs.ext4</span> /dev/zpln/root</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="ex">mkswap</span> /dev/zpln/swap</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">swapon</span> /dev/zpln/swap</span></code></pre></div>
  <h4 data-number="2.3.1.5" id="mount-partitions"><span
  class="header-section-number">2.3.1.5</span> Mount Partitions</h4>
  <p>The <code>/mnt</code> directory is used as the default mount point
  in this handbook.</p>
  <p>Mount the root volume:</p>
  <div class="sourceCode" id="cb6"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> /dev/zpln/root /mnt</span></code></pre></div>
  <p>Mount the boot partition:</p>
  <div class="sourceCode" id="cb7"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> /mnt/boot</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> /dev/sda1 /mnt/boot</span></code></pre></div>
  <h2 data-number="2.4" id="install-base-system"><span
  class="header-section-number">2.4</span> Install Base System</h2>
  <p>Download, verify, and extract the rootfs tarball to set up your
  base system.</p>
  <h3 data-number="2.4.1" id="download-rootfs-tarball"><span
  class="header-section-number">2.4.1</span> Download Rootfs
  Tarball</h3>
  <p>Download the tarball directly into the <code>/mnt</code> directory
  (the default mount point) to avoid using live media RAM.</p>
  <p>The current Zeppe-Lin release is published at<br />
  <a href="https://github.com/zeppe-lin/pkgsrc-core/releases/latest"
  class="uri">https://github.com/zeppe-lin/pkgsrc-core/releases/latest</a></p>
  <p>Identify the release version (e.g., <code>vX.Y</code>), then
  download the corresponding rootfs archive and its detached
  signature:</p>
  <div class="sourceCode" id="cb8"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /mnt</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="va">URL</span><span class="op">=</span>https://github.com/zeppe-lin/pkgsrc-core/releases/download</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="va">VERSION</span><span class="op">=</span>vX.Y</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> <span class="at">-c</span> <span class="va">${URL}</span>/<span class="va">${VERSION}</span>/rootfs-<span class="va">${VERSION}</span>-x86_64.tar.xz <span class="dt">\</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">${URL}</span>/<span class="va">${VERSION}</span>/rootfs-<span class="va">${VERSION}</span>-x86_64.tar.xz.sig</span></code></pre></div>
  <h3 data-number="2.4.2" id="verify-downloaded-tarball"><span
  class="header-section-number">2.4.2</span> Verify Downloaded
  Tarball</h3>
  <p>The tarball is signed with GPG. For security, verifying its
  integrity is highly recommended.</p>
  <p>Import the public key:</p>
  <div class="sourceCode" id="cb9"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">gpg</span> <span class="at">--keyserver</span> keyserver.ubuntu.com <span class="at">--recv-keys</span> 59ec1986fbd902cf</span></code></pre></div>
  <p>Verify the signature:</p>
  <div class="sourceCode" id="cb10"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">gpg</span> <span class="at">--verify</span> rootfs-<span class="va">${VERSION}</span>-x86_64.tar.xz.sig <span class="dt">\</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        rootfs-<span class="va">${VERSION}</span>-x86_64.tar.xz</span></code></pre></div>
  <h3 data-number="2.4.3" id="extract-rootfs-tarball"><span
  class="header-section-number">2.4.3</span> Extract Rootfs Tarball</h3>
  <p>Once the rootfs tarball is downloaded and verified, extract its
  contents using the following command. Make sure to replace
  <code>${VERSION}</code> with the version you downloaded:</p>
  <div class="sourceCode" id="cb11"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> <span class="at">--numeric-owner</span> <span class="at">--xattrs</span> <span class="at">--xattrs-include</span><span class="op">=</span><span class="st">&#39;*&#39;</span> <span class="at">-xpf</span> <span class="dt">\</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        rootfs-<span class="va">${VERSION}</span>-x86_64.tar.xz</span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>It is critical to use all the specified options to ensure proper
  extraction. Here’s what each option does:</p>
  <ul>
  <li><p><code>--numeric-owner</code></p>
  <p>Ensures numeric UIDs and GIDs from the tarball are preserved,
  avoiding mismatches caused by the UID/GID mappings on the live
  system.</p></li>
  <li><p><code>--xattrs --xattrs-include='*'</code></p>
  <p>Preserves filesystem extended attributes, which are used for Linux
  capabilities (e.g., allowing programs like <code>ping(8)</code>
  enhanced privileges without requiring
  <code>suid root</code>).</p></li>
  <li><p><code>-xpf</code></p>
  <p>Extracts (<code>x</code>), preserves permissions and ownership
  (<code>p</code>), and uses the specified file
  (<code>f</code>).</p></li>
  </ul>
  </blockquote>
  <h2 data-number="2.5" id="chroot-into-base-system"><span
  class="header-section-number">2.5</span> Chroot Into Base System</h2>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>Copy the DNS configuration to ensure network access inside the
  chroot, which is needed for updates and installing software:</p>
  <div class="sourceCode" id="cb12"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> /etc/resolv.conf /mnt/etc/resolv.conf</span></code></pre></div>
  </blockquote>
  <p>Mount necessary pseudo-filesystems:</p>
  <div class="sourceCode" id="cb13"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> <span class="at">-B</span> /dev /mnt/dev</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> <span class="at">-B</span> /tmp /mnt/tmp</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> <span class="at">-B</span> /run /mnt/run</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> <span class="at">-t</span> proc proc /mnt/proc</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> <span class="at">-t</span> sysfs none /mnt/sys</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> <span class="at">-t</span> devpts <span class="at">-o</span> noexec,nosuid,gid=tty,mode=0620 devpts <span class="dt">\</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        /mnt/dev/pts</span></code></pre></div>
  <p><strong>For UEFI systems</strong>, mount EFI variables:</p>
  <div class="sourceCode" id="cb14"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> <span class="at">-B</span> /sys/firmware/efi/efivars /mnt/sys/firmware/efi/efivars</span></code></pre></div>
  <p>Enter the chroot:</p>
  <div class="sourceCode" id="cb15"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chroot</span> /mnt /bin/bash</span></code></pre></div>
  <p>Set the <code>SHELL</code> variable to <code>/bin/bash</code> to
  ensure tools like <code>vim</code> work properly:</p>
  <div class="sourceCode" id="cb16"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">SHELL</span><span class="op">=</span>/bin/bash</span></code></pre></div>
  <h2 data-number="2.6" id="configure-base-system"><span
  class="header-section-number">2.6</span> Configure Base System</h2>
  <p>Set the root password:</p>
  <div class="sourceCode" id="cb17"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">passwd</span> root</span></code></pre></div>
  <p>Ensure proper ownership and permissions:</p>
  <div class="sourceCode" id="cb18"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chown</span> root:root /</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 755 /</span></code></pre></div>
  <p>Generate necessary locales (e.g., <code>en_US</code>):</p>
  <div class="sourceCode" id="cb19"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="ex">localedef</span> <span class="at">-i</span> en_US <span class="at">-f</span> UTF-8 en_US.UTF-8</span></code></pre></div>
  <p>Set the system default locale by adding it to
  <code>/etc/profile</code>:</p>
  <div class="sourceCode" id="cb20"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">LANG</span><span class="op">=</span>en_US.UTF-8</span></code></pre></div>
  <p>See <a href="#generating-locales">Generating Locales</a> for
  details.</p>
  <p>Edit <code>/etc/fstab</code> to configure filesystems (see
  <code>fstab(5)</code>). Example for <a
  href="#uefi-and-lvm-on-luks">UEFI and LVM on LUKS</a>:</p>
  <pre class="fstab"><code>/dev/zpln/root  /      ext4  defaults,noatime,nodiratime  1 2
/dev/sda1       /boot  vfat  defaults,noatime,nodiratime  1 2
/dev/zpln/swap  swap   swap  defaults                     0 0</code></pre>
  <blockquote>
  <p><strong>Note:</strong></p>
  <p>Use <code>UUID=...</code> or <code>/dev/disk/by-uuid/*</code>
  instead of <code>/dev/*</code> for better reliability on multi-disk
  systems. Find UUIDs with:</p>
  <div class="sourceCode" id="cb22"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="ex">blkid</span> <span class="at">-o</span> value <span class="at">-s</span> UUID <span class="op">&lt;</span>DEVICE<span class="op">&gt;</span></span></code></pre></div>
  </blockquote>
  <p>Edit <code>/etc/rc.conf</code> (see <code>rc.conf(5)</code>) to
  configure system settings like console font, keyboard, timezone,
  hostname, and services.</p>
  <p>Configure network settings in <code>/etc/rc.d/net</code>,
  <code>/etc/hosts</code>, and <code>/etc/resolv.conf</code> (see <a
  href="#networking">Networking</a>).</p>
  <h3 data-number="2.6.1" id="mount-additional-filesystems"><span
  class="header-section-number">2.6.1</span> Mount Additional
  Filesystems</h3>
  <p>Before building and installing additional software, mount
  additional pseudo-filesystems.</p>
  <p>Shared memory (needed by some builds, e.g.,
  <code>python3</code>):</p>
  <div class="sourceCode" id="cb23"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> /dev/shm</span></code></pre></div>
  <p>Optional package build directory (RAM builds):</p>
  <div class="sourceCode" id="cb24"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> /var/cache/pkgmk/work</span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>Mount <code>/var/cache/pkgmk/work</code> only if enabled in
  <code>/etc/fstab</code> and you have enough RAM.</p>
  </blockquote>
  <h3 data-number="2.6.2" id="configure-users-and-privileges"><span
  class="header-section-number">2.6.2</span> Configure Users and
  Privileges</h3>
  <p>Add a regular user (set a specific UID now if needed):</p>
  <div class="sourceCode" id="cb25"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="ex">useradd</span> <span class="at">--shell</span> /bin/bash <span class="dt">\</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">--create-home</span>  <span class="dt">\</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">--groups</span> audio,video,scanner,cdrom,input,users <span class="dt">\</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">--uid</span> 1000 <span class="dt">\</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">--user-group</span> <span class="op">&lt;</span>USERNAME<span class="op">&gt;</span></span></code></pre></div>
  <p>Set the password:</p>
  <div class="sourceCode" id="cb26"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">passwd</span> <span class="op">&lt;</span>USERNAME<span class="op">&gt;</span></span></code></pre></div>
  <p>To grant administrative privileges (e.g., as Ubuntu does), first
  add the user to the <code>wheel</code> group:</p>
  <div class="sourceCode" id="cb27"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="ex">usermod</span> <span class="at">-aG</span> wheel <span class="op">&lt;</span>USERNAME<span class="op">&gt;</span></span></code></pre></div>
  <p>And second, grant the users in the <code>wheel</code> group to be
  root via <code>sudo(8)</code> by creating the file
  <code>/etc/sudoers.d/00_wheel</code> with the following content:</p>
  <pre class="sudoers"><code>%wheel ALL=(ALL:ALL) ALL</code></pre>
  <h2 data-number="2.7" id="update-the-base-system"><span
  class="header-section-number">2.7</span> Update the Base System</h2>
  <p>Before building and installing additional packages, it is highly
  recommended to update the freshly installed Zeppe-Lin system.</p>
  <h3 data-number="2.7.1" id="prepare-pkgsrc-collections"><span
  class="header-section-number">2.7.1</span> Prepare Pkgsrc
  Collections</h3>
  <p>Packages’ sources are organized into <a
  href="#collections">collections</a>.</p>
  <p>Clone the necessary collections, keeping in mind that each depends
  on the previous one:</p>
  <div class="sourceCode" id="cb29"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /usr/src/</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="va">URL</span><span class="op">=</span>https://github.com/zeppe-lin</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone <span class="va">${URL}</span>/pkgsrc-core    <span class="at">--branch</span> 1.x</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone <span class="va">${URL}</span>/pkgsrc-system  <span class="at">--branch</span> 1.x</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone <span class="va">${URL}</span>/pkgsrc-xorg    <span class="at">--branch</span> 1.x</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone <span class="va">${URL}</span>/pkgsrc-desktop <span class="at">--branch</span> 1.x</span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>The <code>1.x</code> branch applies to all <strong>1.</strong>
  releases (1.0, 1.1, 1.2, …). When a new major line appears, switch to
  its branch (e.g., <code>2.x</code>). Verify your release against the
  <a href="index.html#current-release">current release</a> or the <a
  href="https://github.com/zeppe-lin/pkgsrc-core/releases/latest">pkgsrc-core
  releases page</a>.</p>
  </blockquote>
  <p>Enable the cloned collections in <code>/etc/pkgman.conf</code>. By
  default, only <code>pkgsrc-core</code> collection is enabled.</p>
  <h3 data-number="2.7.2" id="perform-the-system-update"><span
  class="header-section-number">2.7.2</span> Perform the System
  Update</h3>
  <p>Perform a full system update with dependency handling and sorting,
  and stop if the installation of at least one package fails:</p>
  <div class="sourceCode" id="cb30"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> sysup <span class="at">--deps</span> <span class="at">--depsort</span> <span class="at">--group</span></span></code></pre></div>
  <p>Merge any rejected files during update:</p>
  <div class="sourceCode" id="cb31"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="ex">rejmerge</span></span></code></pre></div>
  <p>Check for broken packages and rebuild as needed:</p>
  <div class="sourceCode" id="cb32"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> update <span class="at">-fr</span> <span class="at">--depsort</span> <span class="va">$(</span><span class="ex">revdep</span><span class="va">)</span></span></code></pre></div>
  <p>Here, <code>revdep(1)</code> identifies packages with broken
  dependencies, and if any are reported, <code>pkgman update -fr</code>
  rebuilds the affected packages.</p>
  <h2 data-number="2.8" id="install-essential-packages"><span
  class="header-section-number">2.8</span> Install Essential
  Packages</h2>
  <p>Install packages required for a minimal, functional
  workstation:</p>
  <div class="sourceCode" id="cb33"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">--deps</span> <span class="at">--group</span> <span class="dt">\</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        cryptsetup e2fsprogs dosfstools grub2 grub2-efi iw gnupg <span class="dt">\</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        lvm2 pinentry wireless-tools wpa-supplicant dhcpcd iputils</span></code></pre></div>
  <p>This is a generic setup; users can add any additional packages they
  require based on their specific needs.</p>
  <blockquote>
  <p><strong>Note:</strong></p>
  <p>For network setup and configuration details, see <a
  href="#networking">Networking</a>.</p>
  <p>If you set up a networking bridge, specify the bridge interface in
  the <code>/etc/rc.d/dhcpcd</code> and/or
  <code>/etc/rc.d/wpa_supplicant</code>.</p>
  </blockquote>
  <h2 data-number="2.9" id="kernel-setup"><span
  class="header-section-number">2.9</span> Kernel Setup</h2>
  <p>Two methods are available: build and install a package or compile
  manually.</p>
  <h3 data-number="2.9.1" id="kernel-package"><span
  class="header-section-number">2.9.1</span> Kernel Package</h3>
  <p>Build and install the packaged Linux kernel:</p>
  <div class="sourceCode" id="cb34"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">--deps</span> <span class="at">--group</span> <span class="at">--config-append</span><span class="op">=</span><span class="st">&quot;runscripts no&quot;</span> linux</span></code></pre></div>
  <p>The <code>linux</code> package includes a <code>post-install</code>
  script that runs <code>mkinitramfs(8)</code> and updates the GRUB
  config. This script is disabled here through
  <code>--config-append="runscripts no"</code> to run manually
  later.</p>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>When you update the <code>linux</code> package through the package
  manager, the old kernel and its modules are removed as part of the
  update process. This can cause issues if the system is still using the
  old kernel while the new one is being installed. To avoid these
  problems, it is recommended to <strong>lock</strong> the
  <code>linux</code> package from automatic updates and handle kernel
  updates separately using <code>pkgman-update(8)</code>. See
  <code>pkgman-lock(8)</code> for details.</p>
  </blockquote>
  <p>If you installed the kernel using this method, proceed to <a
  href="#kernel-firmware">Kernel Firmware</a> if your system requires
  additional firmware, or <a href="#initramfs">Initramfs</a>
  otherwise.</p>
  <h3 data-number="2.9.2" id="manual-kernel-compilation"><span
  class="header-section-number">2.9.2</span> Manual Kernel
  Compilation</h3>
  <p>This method suits those wanting a minimal kernel or needing sources
  for driver building (e.g., Nvidia, VirtualBox).</p>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>Use the kernel version from Zeppe-Lin’s package sources for best
  compatibility. Other versions might cause issues.</p>
  </blockquote>
  <p>Download sources:</p>
  <div class="sourceCode" id="cb35"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">-do</span> linux</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="va">KV</span><span class="op">=</span><span class="va">$(</span><span class="ex">pkgman</span> printf %v <span class="at">--filter</span><span class="op">=</span>linux<span class="va">)</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> <span class="at">-xvf</span> /var/cache/pkgmk/sources/linux-<span class="va">${KV}</span>.tar.<span class="pp">?</span>z <span class="at">-C</span> /usr/src/</span></code></pre></div>
  <p>Apply Zeppe-Lin patches:</p>
  <div class="sourceCode" id="cb36"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /usr/src/linux-<span class="va">${KV}</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> <span class="va">$(</span><span class="ex">pkgman</span> path linux<span class="va">)</span>/<span class="pp">*</span>.patch<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">[</span> <span class="ot">-f</span> <span class="st">&quot;</span><span class="va">$p</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="fu">patch</span> <span class="at">-Np1</span> <span class="at">-i</span> <span class="st">&quot;</span><span class="va">$p</span><span class="st">&quot;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>It is highly recommended to perform a dry run to check for errors
  before applying. To do this, simply add <code>--dry-run</code> option
  to the <code>patch(1)</code> command within the loop shown above.</p>
  </blockquote>
  <p>Configure kernel (choose one of the following):</p>
  <ul>
  <li><p><strong>Custom Configuration</strong>:</p>
  <p>Run the menu-based kernel configurator to manually select kernel
  features:</p>
  <div class="sourceCode" id="cb37"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> menuconfig</span></code></pre></div></li>
  <li><p><strong>Use Package Defaults</strong>:</p>
  <p>Apply the default configuration from the package:</p>
  <div class="sourceCode" id="cb38"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> <span class="va">$(</span><span class="ex">pkgman</span> path linux<span class="va">)</span>/x86_64-dotconfig .config</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> olddefconfig</span></code></pre></div>
  <p>Build and install:</p>
  <div class="sourceCode" id="cb39"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> <span class="at">-j</span><span class="va">$(</span><span class="fu">nproc</span><span class="va">)</span> all</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> arch/x86/boot/bzImage /boot/vmlinuz-<span class="va">${KV}</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> .config /boot/config-<span class="va">${KV}</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> modules_install</span></code></pre></div></li>
  </ul>
  <p>Next steps:</p>
  <ul>
  <li>Firmware needed? Proceed to <a href="#kernel-firmware">Kernel
  Firmware</a>.</li>
  <li>No firmware needed? Go to <a href="#initramfs">Initramfs</a>.</li>
  </ul>
  <h2 data-number="2.10" id="kernel-firmware"><span
  class="header-section-number">2.10</span> Kernel Firmware</h2>
  <p>Some hardware (like certain Wi-Fi or graphics cards) needs extra
  firmware.</p>
  <p>Install non-free firmware if required:</p>
  <div class="sourceCode" id="cb40"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">--deps</span> <span class="at">--group</span> linux-firmware</span></code></pre></div>
  <p>Skip this if you prefer a completely free software system.</p>
  <h2 data-number="2.11" id="initramfs"><span
  class="header-section-number">2.11</span> Initramfs</h2>
  <p>First, install <code>mkinitramfs</code>:</p>
  <div class="sourceCode" id="cb41"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">--deps</span> <span class="at">--group</span> mkinitramfs</span></code></pre></div>
  <p>The <code>/etc/mkinitramfs/config</code> file controls how
  <code>mkinitramfs(8)</code> builds the initial ramdisk image used at
  boot. It controls which modules, hooks, and settings are included in
  the initramfs image.</p>
  <p>Here’s an example for <a href="#uefi-and-lvm-on-luks">UEFI and LVM
  on LUKS</a>:</p>
  <div class="sourceCode" id="cb42"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># /etc/mkinitramfs/config</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="va">hostonly</span><span class="op">=</span>1 <span class="co"># optional, creates smaller initramfs</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="va">compress</span><span class="op">=</span><span class="st">&quot;gzip --fast&quot;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="va">hooks</span><span class="op">=</span><span class="st">&quot;eudev luks lvm resume&quot;</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="va">root</span><span class="op">=</span>/dev/zpln/root</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="va">root_type</span><span class="op">=</span>ext4</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="va">resume</span><span class="op">=</span>/dev/zpln/swap</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="va">luks_name</span><span class="op">=</span>crypt</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="va">luks_root</span><span class="op">=</span>/dev/sda2</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># End of file.</span></span></code></pre></div>
  <p>See <code>mkinitramfs.config(5)</code> for more information.</p>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>The <code>hostonly=1</code> setting creates a smaller initramfs
  with only necessary modules. If you move the drive to different
  hardware later, it might not boot.</p>
  </blockquote>
  <blockquote>
  <p><strong>Note:</strong></p>
  <p>For multi-disk systems, using <code>UUID=...</code> or
  <code>/dev/disk/by-uuid/*</code> instead of <code>/dev/*</code> in the
  config can prevent boot issues. Find UUIDs with:</p>
  <div class="sourceCode" id="cb43"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="ex">blkid</span> <span class="at">-o</span> value <span class="at">-s</span> UUID <span class="op">&lt;</span>DEVICE<span class="op">&gt;</span></span></code></pre></div>
  </blockquote>
  <p>Now, prepare an initramfs. If you installed the Linux kernel
  manually, you have already set <code>KV</code> variable to kernel
  version. Otherwise, fetch the kernel version from the package
  source:</p>
  <div class="sourceCode" id="cb44"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="va">KV</span><span class="op">=</span><span class="va">$(</span><span class="ex">pkgman</span> printf %v <span class="at">--filter</span><span class="op">=</span>linux<span class="va">)</span></span></code></pre></div>
  <p>Finally, generate the initramfs image:</p>
  <div class="sourceCode" id="cb45"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="ex">mkinitramfs</span> <span class="at">-o</span> /boot/initramfs-<span class="va">${KV}</span>.img <span class="at">-k</span> <span class="va">${KV}</span></span></code></pre></div>
  <h2 data-number="2.12" id="bootloader"><span
  class="header-section-number">2.12</span> Bootloader</h2>
  <p>This section covers installing GRUB2 as your bootloader. Support
  for other bootloaders may be added later.</p>
  <h3 data-number="2.12.1" id="grub2"><span
  class="header-section-number">2.12.1</span> GRUB2</h3>
  <p>Create <code>/etc/default/grub</code> with:</p>
  <div class="sourceCode" id="cb46"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the delay before booting:</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="va">GRUB_TIMEOUT</span><span class="op">=</span>3</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Show ZPLN in the GRUB menu:</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="va">GRUB_DISTRIBUTOR</span><span class="op">=</span>ZPLN</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set kernel parameters (quiet boot, swap for hibernation):</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="va">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="op">=</span><span class="st">&quot;quiet resume=/dev/zpln/swap&quot;</span></span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>For better reliability on multi-disk systems, use
  <code>UUID=...</code> instead of <code>/dev/*</code> for the resume
  partition.</p>
  <p>Find the UUID with:</p>
  <div class="sourceCode" id="cb47"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="ex">blkid</span> <span class="at">-o</span> value <span class="at">-s</span> UUID <span class="op">&lt;</span>DEVICE<span class="op">&gt;</span></span></code></pre></div>
  </blockquote>
  <p>Next, install GRUB2 on your target drive. Example device:
  <code>/dev/sda</code>. Replace with your actual device (e.g.,
  <code>/dev/sdb</code>, <code>/dev/nvme0n1</code>).</p>
  <p><strong>For UEFI</strong>, ensure the EFI System Partition (ESP) is
  mounted at <code>/boot/efi</code> inside the chroot. Then install GRUB
  with EFI support:</p>
  <div class="sourceCode" id="cb48"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="ex">grub-install</span> <span class="at">--target</span><span class="op">=</span>x86_64-efi <span class="at">--efi-directory</span><span class="op">=</span>/boot /dev/sda</span></code></pre></div>
  <p><strong>For legacy BIOS booting</strong>, install GRUB directly to
  the disk’s MBR:</p>
  <div class="sourceCode" id="cb49"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="ex">grub-install</span> <span class="at">--target</span><span class="op">=</span>i386-pc /dev/sda</span></code></pre></div>
  <p>Finally, generate the GRUB2 configuration file based on
  <code>/etc/default/grub</code> and detected kernels:</p>
  <div class="sourceCode" id="cb50"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="ex">grub-mkconfig</span> <span class="at">-o</span> /boot/grub/grub.cfg</span></code></pre></div>
  <h2 data-number="2.13" id="post-installation-tasks"><span
  class="header-section-number">2.13</span> Post-installation Tasks</h2>
  <h3 data-number="2.13.1" id="install-xorg-and-drivers"><span
  class="header-section-number">2.13.1</span> Install Xorg and
  Drivers</h3>
  <p>To find video and input drivers, run:</p>
  <div class="sourceCode" id="cb51"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> search <span class="at">-vv</span> xf86-</span></code></pre></div>
  <p>Common video drivers include <code>xorg-xf86-video-intel</code>
  (Intel),
  <code>xorg-xf86-video-amdgpu</code>/<code>xorg-xf86-video-ati</code>
  (AMD), and <code>xorg-xf86-video-nouveau</code> (NVIDIA). For NVIDIA,
  the <code>nouveau-firmware</code> is also recommended.</p>
  <p>For input, modern drivers like
  <code>xorg-xf86-input-libinput</code> and
  <code>xorg-xf86-input-evdev</code> are recommended. Legacy options
  like <code>xorg-xf86-input-keyboard</code> and
  <code>xorg-xf86-input-mouse</code> are also available.</p>
  <p>After selecting drivers for your hardware, install
  <code>xorg</code> meta-package and additional drivers with:</p>
  <div class="sourceCode" id="cb52"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">--deps</span> <span class="at">--group</span> xorg <span class="pp">[</span><span class="ss">DRIVERS</span><span class="pp">]</span></span></code></pre></div>
  <p>Replace <code>[DRIVERS]</code> with the ones matching your
  system.</p>
  <h3 data-number="2.13.2" id="install-a-window-manager"><span
  class="header-section-number">2.13.2</span> Install a Window
  Manager</h3>
  <p>Zeppe-Lin focuses on lightweight and efficient window managers
  rather than complex desktop environments like GNOME or KDE. This
  approach avoids unnecessary dependencies and simplifies
  configuration.</p>
  <p>Zeppe-Lin provides package sources for several window managers, but
  users are welcome to choose and contribute package sources for any
  window manager they prefer.</p>
  <p>To find available window managers, run:</p>
  <div class="sourceCode" id="cb53"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> dsearch <span class="at">-vv</span> <span class="st">&#39;window manager&#39;</span></span></code></pre></div>
  <p>Install with:</p>
  <div class="sourceCode" id="cb54"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">--deps</span> <span class="at">--group</span> <span class="pp">[</span><span class="ss">WM</span><span class="pp">]</span></span></code></pre></div>
  <p>Replace <code>[WM]</code> with the window manager from the list
  (e.g., <code>icewm</code>).</p>
  <h4 data-number="2.13.2.1" id="unofficial-window-maker"><span
  class="header-section-number">2.13.2.1</span> Unofficial: Window
  Maker</h4>
  <p>For users interested in a retro, intuitive window manager, you can
  install <strong>Window Maker</strong> from the unofficial
  <code>pkgsrc-wmaker</code> repository.</p>
  <blockquote>
  <p><strong>Warning:</strong></p>
  <p>Using unofficial repositories means the packages might not follow
  the same update schedule or quality standards as the official
  repositories. <strong>Use with caution.</strong></p>
  </blockquote>
  <p>To install Window Maker, first clone the repository:</p>
  <div class="sourceCode" id="cb55"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /usr/src</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="va">URL</span><span class="op">=</span>https://github.com/zeppe-lin</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone <span class="va">${URL}</span>/pkgsrc-wmaker <span class="at">--branch</span> 1.x</span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>The <code>1.x</code> branch applies to all <strong>1.</strong>
  releases (1.0, 1.1, 1.2, …). When a new major line appears, switch to
  its branch (e.g., <code>2.x</code>). Verify your release against the
  <a href="index.html#current-release">current release</a> or the <a
  href="https://github.com/zeppe-lin/pkgsrc-core/releases/latest">pkgsrc-core
  releases page</a>.</p>
  </blockquote>
  <p>Next, you need to tell <code>pkgman(1)</code> about this new
  repository by adding the following line to
  <code>/etc/pkgman.conf</code>:</p>
  <pre><code>pkgsrcdir /usr/src/pkgsrc-wmaker</code></pre>
  <p>Then, install it with:</p>
  <div class="sourceCode" id="cb57"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">--deps</span> <span class="at">--group</span> wmaker</span></code></pre></div>
  <p>Optional meta-packages for Window Maker include
  <code>wmaker-dockapps</code> for added functionality and
  <code>wmaker-themes</code> for customization.</p>
  <h2 data-number="2.14" id="reboot"><span
  class="header-section-number">2.14</span> Reboot</h2>
  <p>Exit the chroot:</p>
  <div class="sourceCode" id="cb58"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chrooted, as root</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="bu">exit</span></span></code></pre></div>
  <p>Unmount all filesystems, and reboot:</p>
  <div class="sourceCode" id="cb59"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">umount</span> <span class="at">-R</span> /mnt</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="ex">shutdown</span> <span class="at">-r</span> now</span></code></pre></div>
  <p>The GRUB menu should appear, allowing you to boot into
  Zeppe-Lin.</p>
  <hr />
  <h1 data-number="3" id="upgrading"><span
  class="header-section-number">3</span> UPGRADING</h1>
  <p><strong>WARNING! THIS SECTION IS UNDER DEVELOPMENT AND CANNOT BE
  USED AS A MANUAL!</strong></p>
  <p>Upgrading Zeppe-Lin requires careful planning. This section
  outlines methods for updating your system. Follow the steps as
  presented to ensure a reliable upgrade.</p>
  <p>Upgrade methods:</p>
  <ol type="1">
  <li>Quick binary upgrade (core components).</li>
  <li>Full update from sources.</li>
  </ol>
  <p>Before starting, read the release notes for the target version and
  back up important data.</p>
  <h2 data-number="3.1" id="release-notes"><span
  class="header-section-number">3.1</span> Release Notes</h2>
  <p>Read the release notes for the new Zeppe-Lin version. They contain
  essential details about new features, removed packages, and
  compatibility issues. The latest release notes you can obtain <a
  href="https://zeppe-lin.github.io/index.html#latest-release">here</a>.</p>
  <h2 data-number="3.2" id="set-release-and-sync"><span
  class="header-section-number">3.2</span> Set Release And Sync</h2>
  <p>To upgrade, synchronize your local pkgsrc collections with the new
  release branch. Replace <code>1.x</code> with the actual release
  branch you are targeting.</p>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>The <code>1.x</code> branch applies to all <strong>1.</strong>
  releases (1.0, 1.1, 1.2, …). When a new major line appears, switch to
  its branch (e.g., <code>2.x</code>). Verify your release against the
  <a href="index.html#current-release">current release</a> or the <a
  href="https://github.com/zeppe-lin/pkgsrc-core/releases/latest">pkgsrc-core
  releases page</a>.</p>
  </blockquote>
  <ol type="1">
  <li><p><strong>Fetch the latest branches</strong> to ensure the
  release branch is available locally:</p>
  <div class="sourceCode" id="cb60"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> core system xorg desktop<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">git</span> <span class="at">-C</span> /usr/src/pkgsrc-<span class="va">$x</span> fetch <span class="at">--all</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div></li>
  <li><p><strong>Switch each repository</strong> to the new release
  branch:</p>
  <div class="sourceCode" id="cb61"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> core system xorg desktop<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">git</span> <span class="at">-C</span> /usr/src/pkgsrc-<span class="va">$x</span> switch <span class="at">--track</span> origin/1.x</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
  <p>If the branch already exists locally, you can omit
  <code>--track origin/1.x</code> and simply run
  <code>git switch 1.x</code>.</p></li>
  <li><p><strong>Verify branch status</strong>:</p>
  <div class="sourceCode" id="cb62"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> core system xorg desktop<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">git</span> <span class="at">-C</span> /usr/src/pkgsrc-<span class="va">$x</span> status</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
  <p>This confirms that each collection is now aligned with the chosen
  release branch.</p></li>
  </ol>
  <h3 data-number="3.2.1" id="binary-upgrade"><span
  class="header-section-number">3.2.1</span> Binary Upgrade</h3>
  <p>Use precompiled binary packages for faster core system upgrades,
  especially to avoid build issues during initial updates.</p>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>Upgrades may cause file conflicts, such as a file being reassigned
  between packages. To prevent issues, read the release notes for the
  target Zeppe-Lin version. They detail package changes like removals,
  merges, or renames that may require manual intervention.</p>
  </blockquote>
  <h4 data-number="3.2.1.1" id="download-and-extract-binpkgs"><span
  class="header-section-number">3.2.1.1</span> Download and Extract
  binpkgs</h4>
  <blockquote>
  <p><strong>Note:</strong></p>
  <p>Verify the integrity of the downloaded <code>binpkgs</code> tarball
  before extracting it. It is signed using the same method as the
  Zeppe-Lin root filesystem image.</p>
  </blockquote>
  <p>Download the tarball and its signature for your upgrade, replacing
  <code>v1.0</code> with the target version:</p>
  <div class="sourceCode" id="cb63"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="va">URL</span><span class="op">=</span>https://github.com/zeppe-lin/pkgsrc-core/releases/download</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="va">VERSION</span><span class="op">=</span>v1.0</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> <span class="at">-c</span> <span class="va">${URL}</span>/<span class="va">${VERSION}</span>/binpkgs-<span class="va">${VERSION}</span>-x86_64.tar.xz<span class="dt">{</span><span class="op">,</span><span class="dt">.sig}</span></span></code></pre></div>
  <p>Verify the tarball with <code>gpg(1)</code>:</p>
  <div class="sourceCode" id="cb64"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gpg</span> <span class="at">--keyserver</span> keyserver.ubuntu.com <span class="at">--recv-keys</span> 59ec1986fbd902cf</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="ex">gpg</span> <span class="at">--verify</span> binpkgs-<span class="va">${VERSION}</span>-x86_64.tar.xz<span class="dt">{.sig</span><span class="op">,</span><span class="dt">}</span></span></code></pre></div>
  <p>Extract the tarball after successful verification:</p>
  <div class="sourceCode" id="cb65"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ~/binpkgs</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> <span class="at">-xf</span> binpkgs-<span class="va">${VERSION}</span>-x86_64.tar.xz <span class="at">-C</span> ~/binpkgs</span></code></pre></div>
  <h4 data-number="3.2.1.2" id="upgrade-core-packages"><span
  class="header-section-number">3.2.1.2</span> Upgrade Core
  Packages</h4>
  <p>Navigate to the directory and upgrade core packages:</p>
  <div class="sourceCode" id="cb66"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~/binpkgs</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># as root, upgrade all upgradeable packages</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> <span class="pp">*</span>.pkg.tar.gz<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="ex">pkgadd</span> <span class="at">-u</span> <span class="st">&quot;</span><span class="va">$p</span><span class="st">&quot;</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
  <p><code>pkgadd -u</code> upgrades each package. New, non-upgradable
  packages will return an error, which the loop skips, ensuring all
  upgradeable packages are updated.</p>
  <h4 data-number="3.2.1.3" id="install-new-core-packages"><span
  class="header-section-number">3.2.1.3</span> Install New Core
  Packages</h4>
  <p>Install new core packages introduced in the release:</p>
  <div class="sourceCode" id="cb67"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~/binpkgs</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># as root, install all new packages</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> <span class="pp">*</span>.pkg.tar.gz<span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="ex">pkgadd</span> <span class="st">&quot;</span><span class="va">$p</span><span class="st">&quot;</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
  <p><code>pkgadd</code> installs each package. Already installed
  packages return an error, which the loop skips to ensure all new
  packages are installed.</p>
  <hr />
  <h1 data-number="4" id="package-management"><span
  class="header-section-number">4</span> PACKAGE MANAGEMENT</h1>
  <h2 data-number="4.1" id="introduction-1"><span
  class="header-section-number">4.1</span> Introduction</h2>
  <p>Zeppe-Lin’s package management system revolves around packages and
  package sources. Low-level tools handle atomic operations like
  building and installation, working with individual package sources or
  packages as instructed. The high-level tool <code>pkgman</code>
  manages the package source collections and orchestrates these
  low-level tasks for system-wide software management.</p>
  <ul>
  <li><p><strong>Packages</strong><br />
  Compressed archives (e.g., <code>tar.gz</code>) containing pre-built
  software.</p></li>
  <li><p><strong>Package Sources</strong><br />
  Files required to create these compressed archives
  (packages).</p></li>
  </ul>
  <p>To work with packages and package sources, Zeppe-Lin provides:</p>
  <table>
  <tbody>
  <tr>
  <td><strong>Low-Level Tools</strong></td>
  <td></td>
  </tr>
  <tr>
  <td><code>pkgmk(8)</code></td>
  <td>Build packages from sources</td>
  </tr>
  <tr>
  <td><code>pkgadd(8)</code></td>
  <td>Install or upgrade a software package</td>
  </tr>
  <tr>
  <td><code>pkgrm(8)</code></td>
  <td>Remove an installed software package</td>
  </tr>
  <tr>
  <td><code>pkginfo(1)</code></td>
  <td>Inspect software package information</td>
  </tr>
  <tr>
  <td><code>rejmerge(8)</code></td>
  <td>Assist with upgrade conflicts</td>
  </tr>
  <tr>
  <td><strong>High-Level Tool</strong></td>
  <td></td>
  </tr>
  <tr>
  <td><code>pkgman(1)</code></td>
  <td>Unified interface for package management</td>
  </tr>
  </tbody>
  </table>
  <p>Packages built with <code>pkgmk(8)</code> are installed or upgraded
  using <code>pkgadd(8)</code>, and removed with <code>pkgrm(8)</code>.
  Files rejected during upgrades are resolved with
  <code>rejmerge(8)</code>.</p>
  <p><code>pkgman(1)</code> orchestrates package sources, dependencies,
  and system updates, integrating <code>pkgmk(8)</code>,
  <code>pkgadd(8)</code> and <code>pkgrm(8)</code>.</p>
  <h2 data-number="4.2" id="what-is-a-package"><span
  class="header-section-number">4.2</span> What is a Package?</h2>
  <p>A Zeppe-Lin package is a compressed archive (e.g.,
  <code>tar.gz</code>) that contains only the software files. It avoids
  any kind of embedded metadata, ensuring simplicity and transparency in
  its structure.</p>
  <h3 data-number="4.2.1" id="package-naming"><span
  class="header-section-number">4.2.1</span> Package Naming</h3>
  <p>Zeppe-Lin packages follow a clear naming convention:</p>
  <pre><code>name#version-release.pkg.tar.gz</code></pre>
  <table>
  <thead>
  <tr>
  <th>Component</th>
  <th>Description</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><code>name</code></td>
  <td>Package name</td>
  </tr>
  <tr>
  <td><code>version</code></td>
  <td>Version number</td>
  </tr>
  <tr>
  <td><code>release</code></td>
  <td>Build revision</td>
  </tr>
  </tbody>
  </table>
  <p>Example:</p>
  <pre><code>ed#1.21-1.pkg.tar.gz</code></pre>
  <p>The extension <code>.pkg.tar.gz</code> denotes a Zeppe-Lin package.
  Other common compression formats like <code>tar.bz2</code>,
  <code>tar.xz</code>, and <code>tar.zst</code> are also supported.</p>
  <h3 data-number="4.2.2" id="package-database"><span
  class="header-section-number">4.2.2</span> Package Database</h3>
  <p>The package database, located at <code>/var/lib/pkg/db</code>,
  tracks installed packages and their contents. Each package entry
  follows this format:</p>
  <div class="sourceCode" id="cb70"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>name<span class="op">&gt;</span>                 <span class="co"># Package name</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>version<span class="op">&gt;</span>-<span class="op">&lt;</span>release<span class="op">&gt;</span>    <span class="co"># Version and release</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>dir<span class="op">&gt;</span>/                 <span class="co"># Top-level directory</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>dir<span class="op">&gt;</span>/<span class="op">&lt;</span>subdir<span class="op">&gt;</span>         <span class="co"># Subdirectory</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>dir<span class="op">&gt;</span>/<span class="op">&lt;</span>subdir<span class="op">&gt;</span>/<span class="op">&lt;</span>file<span class="op">&gt;</span>  <span class="co"># File within subdirectory</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">Blank</span> line<span class="kw">)</span>           <span class="co"># Separates package entries</span></span></code></pre></div>
  <p>Example entry for <code>ed</code>:</p>
  <div class="sourceCode" id="cb71"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ed</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="ex">1.21-1</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="ex">bin/</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="ex">bin/ed</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="ex">usr/</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="ex">usr/share/</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="ex">usr/share/man/</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="ex">usr/share/man/man1/</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="ex">usr/share/man/man1/ed.1.gz</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">Blank</span> line<span class="kw">)</span></span></code></pre></div>
  <blockquote>
  <p><strong>Note:</strong></p>
  <p>This database enables essential operations like installation
  (<code>pkgadd(8)</code>), removal (<code>pkgrm(8)</code>), and
  inspection (<code>pkginfo(8)</code>).</p>
  </blockquote>
  <h2 data-number="4.3" id="low-level-tools-pkgutils"><span
  class="header-section-number">4.3</span> Low-level Tools:
  pkgutils</h2>
  <p><code>pkgutils</code> provides the core utilities to handle
  packages:</p>
  <table>
  <thead>
  <tr>
  <th>Utility</th>
  <th>Description</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><code>pkgadd(8)</code></td>
  <td>Installs or upgrades packages</td>
  </tr>
  <tr>
  <td><code>pkgrm(8)</code></td>
  <td>Removes packages</td>
  </tr>
  <tr>
  <td><code>pkginfo(1)</code></td>
  <td>Displays package details</td>
  </tr>
  </tbody>
  </table>
  <h3 data-number="4.3.1" id="using-pkgutils"><span
  class="header-section-number">4.3.1</span> Using pkgutils</h3>
  <h4 data-number="4.3.1.1" id="installing-a-package"><span
  class="header-section-number">4.3.1.1</span> Installing a Package</h4>
  <p>Install a package file with <code>pkgadd(8)</code>:</p>
  <div class="sourceCode" id="cb72"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgadd</span> bash#5.0.18-1.pkg.tar.gz</span></code></pre></div>
  <p>By default, <code>pkgadd(8)</code> prevents overwriting existing
  files. Use <code>-f</code> or <code>--force</code> to override this
  behavior (<strong>use with caution!</strong>):</p>
  <div class="sourceCode" id="cb73"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgadd</span> <span class="at">-f</span> bash#5.0.18-1.pkg.tar.gz</span></code></pre></div>
  <h4 data-number="4.3.1.2" id="upgrading-a-package"><span
  class="header-section-number">4.3.1.2</span> Upgrading a Package</h4>
  <p>Upgrade a package with the <code>-u</code> or
  <code>--upgrade</code> option:</p>
  <div class="sourceCode" id="cb74"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgadd</span> <span class="at">-u</span> bash#5.0.18-1.pkg.tar.gz</span></code></pre></div>
  <p>This replaces the installed package. If the package is not
  installed, it will return an error. You can even “upgrade” to an older
  version.</p>
  <p>Files that should not be upgraded (based on
  <code>/etc/pkgadd.conf</code>) are placed in
  <code>/var/lib/pkg/rejected/</code>.</p>
  <h4 data-number="4.3.1.3" id="removing-a-package"><span
  class="header-section-number">4.3.1.3</span> Removing a Package</h4>
  <p>To remove a package, use <code>pkgrm(8)</code> followed by the
  package name:</p>
  <div class="sourceCode" id="cb75"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgrm</span> bash</span></code></pre></div>
  <blockquote>
  <p><strong>Caution:</strong></p>
  <p>This command removes all files owned by the package, without
  prompting. Misspelling the package name may remove something entirely
  different (e.g., <code>glib</code> vs. <code>glibc</code>).</p>
  </blockquote>
  <h4 data-number="4.3.1.4" id="inspecting-packages"><span
  class="header-section-number">4.3.1.4</span> Inspecting Packages</h4>
  <p>Use <code>pkginfo(1)</code> to get information about packages.</p>
  <p>List installed packages and versions:</p>
  <div class="sourceCode" id="cb76"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkginfo</span> <span class="at">-i</span></span></code></pre></div>
  <p>List files in a package:</p>
  <div class="sourceCode" id="cb77"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkginfo</span> <span class="at">-l</span> bash</span></code></pre></div>
  <p>List files in a package archive (before installing):</p>
  <div class="sourceCode" id="cb78"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkginfo</span> <span class="at">-l</span> grep#2.5-1.pkg.tar.gz</span></code></pre></div>
  <p>Find which package owns a file:</p>
  <div class="sourceCode" id="cb79"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkginfo</span> <span class="at">-o</span> /usr/bin/ls</span></code></pre></div>
  <p>See <code>pkgadd(8)</code>, <code>pkgrm(8)</code>, and
  <code>pkginfo(1)</code> for details.</p>
  <h3 data-number="4.3.2" id="configuring-pkgadd"><span
  class="header-section-number">4.3.2</span> Configuring pkgadd</h3>
  <p>You can customize <code>pkgadd(8)</code> behavior during package
  upgrades using <code>/etc/pkgadd.conf</code>. Rules define whether
  files should be upgraded or preserved.</p>
  <h4 data-number="4.3.2.1" id="rule-format"><span
  class="header-section-number">4.3.2.1</span> Rule Format</h4>
  <p>Each rule in <code>/etc/pkgadd.conf</code> follows this format:</p>
  <pre><code>EVENT   PATTERN   ACTION</code></pre>
  <table>
  <thead>
  <tr>
  <th>Field</th>
  <th>Description</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><code>EVENT</code></td>
  <td>Currently, only <code>UPGRADE</code> is supported</td>
  </tr>
  <tr>
  <td><code>PATTERN</code></td>
  <td>A regular expression matching filenames in the package</td>
  </tr>
  <tr>
  <td><code>ACTION</code></td>
  <td><code>YES</code> to upgrade files, <code>NO</code> to preserve
  them</td>
  </tr>
  </tbody>
  </table>
  <p>Rules are processed sequentially, with the last matching rule
  taking priority.</p>
  <h4 data-number="4.3.2.2" id="example"><span
  class="header-section-number">4.3.2.2</span> Example</h4>
  <p>Example <code>/etc/pkgadd.conf</code> entries:</p>
  <pre><code>UPGRADE   ^etc/.*$              NO
UPGRADE   ^var/log/.*$          NO
UPGRADE   ^etc/X11/xorg.conf$   YES</code></pre>
  <p>These rules will:</p>
  <ul>
  <li>Keep all files in <code>/etc</code> and its subdirectories.</li>
  <li>Keep all files in <code>/var/log</code> and its
  subdirectories.</li>
  <li>Upgrade <code>/etc/X11/xorg.conf</code> specifically (overrides
  the <code>/etc</code> rule).</li>
  </ul>
  <blockquote>
  <p><strong>Caution</strong>:</p>
  <p>Patterns match filenames inside the package, not full system paths.
  Do not use <strong><code>/</code></strong> at the start!</p>
  </blockquote>
  <p>See <code>pkgadd.conf(5)</code> for details.</p>
  <h2 data-number="4.4" id="low-level-tools-rejmerge"><span
  class="header-section-number">4.4</span> Low-level Tools:
  rejmerge</h2>
  <p><code>rejmerge(8)</code> resolves files rejected during upgrades
  using <code>pkgadd -u</code>. Rejected files are moved to
  <code>/var/lib/pkg/rejected/</code> for manual handling, while
  <code>rejmerge(8)</code> provides a way to manage these files
  semi-automatically.</p>
  <h3 data-number="4.4.1" id="using-rejmerge"><span
  class="header-section-number">4.4.1</span> Using rejmerge</h3>
  <p>If files are present in <code>/var/lib/pkg/rejected</code>,
  <code>rejmerge(8)</code> prompts you to decide their fate. For each
  file, you’ll see a diff and be asked to press a key.</p>
  <p>For example, suppose the <code>bash</code> package updates
  <code>/etc/profile</code>:</p>
  <pre><code>=======&gt; /etc/profile
--- /etc/profile        2024-01-17 15:27:31.498548193 +0200
+++ /var/lib/pkg/rejected/etc/profile   2026-01-29 09:37:11.159726066 +0200
@@ -8,7 +8,6 @@

 export PATH=&quot;/sbin:/usr/sbin:/bin:/usr/bin&quot;
 export LESS=&quot;-RX&quot;
-export LANG=en_US.UTF-8

 umask 022

=======&gt; [K]eep [U]pgrade [M]erge [D]iff [S]kip?</code></pre>
  <p>At this prompt, you press a key to choose:</p>
  <table>
  <colgroup>
  <col style="width: 5%" />
  <col style="width: 5%" />
  <col style="width: 88%" />
  </colgroup>
  <thead>
  <tr>
  <th>Key</th>
  <th>Action</th>
  <th>What it means in this example</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><strong>K</strong></td>
  <td>Keep</td>
  <td>Keep your current <code>/etc/profile</code> (with
  <code>LANG=en_US.UTF-8</code>)</td>
  </tr>
  <tr>
  <td><strong>U</strong></td>
  <td>Upgrade</td>
  <td>Replace with the new package version (without
  <code>LANG=en_US.UTF-8</code>)</td>
  </tr>
  <tr>
  <td><strong>M</strong></td>
  <td>Merge</td>
  <td>Interactively combine both versions, so you can keep
  <code>LANG</code> but also accept other changes</td>
  </tr>
  <tr>
  <td><strong>D</strong></td>
  <td>Diff</td>
  <td>Re-display the differences shown above</td>
  </tr>
  <tr>
  <td><strong>S</strong></td>
  <td>Skip</td>
  <td>Defer the decision; you can revisit later</td>
  </tr>
  </tbody>
  </table>
  <p>See <code>rejmerge(8)</code> for details.</p>
  <h3 data-number="4.4.2" id="configuring-rejmerge"><span
  class="header-section-number">4.4.2</span> Configuring rejmerge</h3>
  <p>Configurations for <code>rejmerge(8)</code> can be adjusted in
  <code>/etc/rejmerge.conf</code>. Key settings:</p>
  <table>
  <colgroup>
  <col style="width: 5%" />
  <col style="width: 5%" />
  <col style="width: 88%" />
  </colgroup>
  <thead>
  <tr>
  <th>Setting</th>
  <th>Type</th>
  <th>Purpose</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><code>rejmerge_diff</code></td>
  <td>function</td>
  <td>Defines how differences between files are displayed</td>
  </tr>
  <tr>
  <td><code>rejmerge_merge</code></td>
  <td>function</td>
  <td>Controls how files are merged interactively</td>
  </tr>
  <tr>
  <td><code>EDITOR</code></td>
  <td>variable</td>
  <td>Specifies the editor used when manual editing is required</td>
  </tr>
  <tr>
  <td><code>PAGER</code></td>
  <td>variable</td>
  <td>Specifies the pager used to view differences</td>
  </tr>
  </tbody>
  </table>
  <h4 data-number="4.4.2.1" id="example-1"><span
  class="header-section-number">4.4.2.1</span> Example</h4>
  <p>Use unified, colorized output for differences:</p>
  <div class="sourceCode" id="cb83"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rejmerge_diff()</span> <span class="kw">{</span> <span class="fu">diff</span> <span class="at">-u</span> <span class="at">--color</span><span class="op">=</span>always <span class="va">$1</span> <span class="va">$2</span> <span class="op">&gt;</span> <span class="va">$3</span> <span class="kw">;</span> <span class="kw">}</span></span></code></pre></div>
  <p>Use <code>sdiff(1)</code> for merging files:</p>
  <div class="sourceCode" id="cb84"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rejmerge_merge()</span> <span class="kw">{</span> <span class="ex">sdiff</span> <span class="at">-o</span> <span class="va">$3</span> <span class="va">$1</span> <span class="va">$2</span> <span class="kw">;</span> <span class="kw">}</span></span></code></pre></div>
  <p>Set preferred editor and pager:</p>
  <div class="sourceCode" id="cb85"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="va">EDITOR</span><span class="op">=</span>vim</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="va">PAGER</span><span class="op">=</span>less</span></code></pre></div>
  <p>See <code>rejmerge.conf(5)</code> for more details.</p>
  <h2 data-number="4.5" id="low-level-tools-pkgmk"><span
  class="header-section-number">4.5</span> Low-level Tools: pkgmk</h2>
  <p><code>pkgmk(8)</code> builds Zeppe-Lin packages (compressed
  archives) from source files using a <code>Pkgfile</code>. These files,
  along with the supporting directory, form a <strong>Package
  Source</strong> – a self-contained unit that includes all files needed
  to build and install software.</p>
  <p>A <strong>Package Source</strong> typically contains:</p>
  <table>
  <thead>
  <tr>
  <th>File</th>
  <th>Purpose</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><code>Pkgfile</code></td>
  <td>Defines metadata and build steps</td>
  </tr>
  <tr>
  <td><code>.md5sum</code></td>
  <td>Ensures the integrity of downloaded files</td>
  </tr>
  <tr>
  <td><code>.footprint</code></td>
  <td>Lists expected files in the final package</td>
  </tr>
  </tbody>
  </table>
  <p>A <strong>Package Source</strong> is the basic unit of software
  organization in Zeppe-Lin. While this section introduces
  <strong>Package Sources</strong> in the context of building packages,
  <a href="#package-sources-and-collections">PACKAGE SOURCES AND
  COLLECTIONS</a> explores their organization into
  <strong>Collections</strong> and <strong>Repositories</strong> for
  broader software management workflows.</p>
  <h3 data-number="4.5.1" id="pkgfile-format"><span
  class="header-section-number">4.5.1</span> Pkgfile Format</h3>
  <p>The <code>Pkgfile</code> defines:</p>
  <ul>
  <li><code>name</code>, <code>version</code>, <code>release</code> —
  Package identity.</li>
  <li><code>source</code> — URL to download the software’s source
  code.</li>
  <li><code>build()</code> — Instructions to compile and package the
  software.</li>
  </ul>
  <h4 data-number="4.5.1.1" id="example-2"><span
  class="header-section-number">4.5.1.1</span> Example</h4>
  <div class="sourceCode" id="cb86"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="va">name</span><span class="op">=</span>hello</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="va">version</span><span class="op">=</span>2.12.1</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="va">release</span><span class="op">=</span>1</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="va">source</span><span class="op">=</span>https://ftp.gnu.org/gnu/hello/<span class="va">$name</span>-<span class="va">$version</span>.tar.gz</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="fu">build()</span> <span class="kw">{</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">cd</span> <span class="va">$name</span>-<span class="va">$version</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>    <span class="ex">./configure</span> <span class="at">--prefix</span><span class="op">=</span>/usr <span class="at">--disable-nls</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make</span> DESTDIR=<span class="va">$PKG</span> install</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span> <span class="at">-rf</span> <span class="va">$PKG</span>/usr/info</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
  <p>See <code>pkgmk.Pkgfile(5)</code> for details.</p>
  <h3 data-number="4.5.2" id="using-pkgmk"><span
  class="header-section-number">4.5.2</span> Using pkgmk</h3>
  <h4 data-number="4.5.2.1" id="building-a-package"><span
  class="header-section-number">4.5.2.1</span> Building a Package</h4>
  <p>To build a package, create a directory named after the package,
  <code>cd</code> into this directory, place the <code>Pkgfile</code>
  inside, and run:</p>
  <div class="sourceCode" id="cb87"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fakeroot</span> pkgmk <span class="at">-d</span> <span class="at">-cf</span> /dev/null</span></code></pre></div>
  <ul>
  <li><code>fakeroot</code> — Always use to avoid system risks.</li>
  <li><code>-d</code> — Downloads missing source files.</li>
  <li><code>-cf /dev/null</code> — Ignores <code>/etc/pkgmk.conf</code>
  and uses defaults.</li>
  </ul>
  <p>On the first build, <code>pkgmk(8)</code> generates:</p>
  <ul>
  <li><code>.footprint</code> — Tracks package contents.</li>
  <li><code>.md5sum</code> — Ensures source files integrity.</li>
  </ul>
  <p>The final package (e.g., <code>hello#2.12.1-1.pkg.tar.gz</code>)
  will be in the current directory.</p>
  <h3 data-number="4.5.3" id="configuring-pkgmk"><span
  class="header-section-number">4.5.3</span> Configuring pkgmk</h3>
  <p>Customize <code>pkgmk(8)</code> with <code>/etc/pkgmk.conf</code>.
  Key settings:</p>
  <table>
  <thead>
  <tr>
  <th>Setting</th>
  <th>Purpose</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><code>CFLAGS</code>, <code>CXXFLAGS</code></td>
  <td>Compiler optimization flags</td>
  </tr>
  <tr>
  <td><code>PKGMK_SOURCE_MIRRORS</code></td>
  <td>Backup URLs for source archives</td>
  </tr>
  <tr>
  <td><code>PKGMK_SOURCE_DIR</code></td>
  <td>Directory for source archives</td>
  </tr>
  <tr>
  <td><code>PKGMK_PACKAGE_DIR</code></td>
  <td>Directory for built packages</td>
  </tr>
  <tr>
  <td><code>PKGMK_WORK_DIR</code></td>
  <td>Temporary build directory</td>
  </tr>
  </tbody>
  </table>
  <h4 data-number="4.5.3.1" id="example-3"><span
  class="header-section-number">4.5.3.1</span> Example</h4>
  <p>Define backup URLs:</p>
  <div class="sourceCode" id="cb88"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="va">PKGMK_SOURCE_MIRRORS</span><span class="op">=</span><span class="st">&quot;http://fileserver.intranet/sources/</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="st">                      http://mirror2/sources/&quot;</span></span></code></pre></div>
  <p>Set a unique work directory:</p>
  <div class="sourceCode" id="cb89"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="va">PKGMK_WORK_DIR</span><span class="op">=</span><span class="st">&quot;/var/cache/pkgmk/work/</span><span class="va">$name</span><span class="st">-</span><span class="va">$$</span><span class="st">&quot;</span></span></code></pre></div>
  <p>Using <code>$name</code> (package name) and <code>$$</code>
  (process ID) avoids conflicts during simultaneous builds.</p>
  <blockquote>
  <p><strong>Note:</strong></p>
  <p>Although unique directories avoid build conflicts,
  <code>pkgadd(8)</code> locks the database, so simultaneous
  installations may fail.</p>
  </blockquote>
  <p>See <code>pkgmk.conf(5)</code> for full options.</p>
  <h2 data-number="4.6" id="high-level-tool-pkgman"><span
  class="header-section-number">4.6</span> High-level Tool: pkgman</h2>
  <p><code>pkgman(1)</code> serves as a versatile interface for managing
  Zeppe-Lin’s package ecosystem. Building on tools like
  <code>pkgutils</code> and <code>pkgmk</code>, it unifies and
  simplifies workflows while supporting a wide range of package
  management tasks.</p>
  <p><code>pkgman(1)</code> empowers users to:</p>
  <ul>
  <li>Handle dependencies and system updates efficiently.</li>
  <li>Automate and streamline build processes.</li>
  <li>Extend functionality with dynamic features and workflows.</li>
  </ul>
  <p>With its adaptable design, <code>pkgman(1)</code> integrates
  seamlessly into diverse system management scenarios, making it an
  indispensable tool for maintaining and customizing Zeppe-Lin.</p>
  <h3 data-number="4.6.1" id="using-pkgman"><span
  class="header-section-number">4.6.1</span> Using pkgman</h3>
  <h4 data-number="4.6.1.1" id="list-installed-packages"><span
  class="header-section-number">4.6.1.1</span> List Installed
  Packages</h4>
  <p>List installed packages:</p>
  <div class="sourceCode" id="cb90"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> list</span></code></pre></div>
  <p>Include versions:</p>
  <div class="sourceCode" id="cb91"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> list <span class="at">-v</span></span></code></pre></div>
  <p>Include versions and descriptions:</p>
  <div class="sourceCode" id="cb92"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> list <span class="at">-vv</span></span></code></pre></div>
  <h4 data-number="4.6.1.2" id="query-package-information"><span
  class="header-section-number">4.6.1.2</span> Query Package
  Information</h4>
  <p>Display detailed package information:</p>
  <div class="sourceCode" id="cb93"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> info acl</span></code></pre></div>
  <p>Example output:</p>
  <pre><code>Name:         acl
Path:         /usr/src/pkgsrc-core
Version:      2.3.1
Release:      1
Description:  Access Control List filesystem support
URL:          http://savannah.nongnu.org/projects/acl
Depends on:   attr</code></pre>
  <h4 data-number="4.6.1.3" id="search-package-sources"><span
  class="header-section-number">4.6.1.3</span> Search Package
  Sources</h4>
  <p>Search by name:</p>
  <div class="sourceCode" id="cb95"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> search <span class="at">-vv</span> glibc</span></code></pre></div>
  <p>Search using regular expressions:</p>
  <div class="sourceCode" id="cb96"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> search <span class="at">-vv</span> <span class="at">--regex</span> <span class="st">&#39;^(glib)c?$&#39;</span></span></code></pre></div>
  <p>Search by description:</p>
  <div class="sourceCode" id="cb97"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> dsearch <span class="at">-vv</span> archive</span></code></pre></div>
  <h4 data-number="4.6.1.4" id="query-dependencies"><span
  class="header-section-number">4.6.1.4</span> Query Dependencies</h4>
  <p>Show direct dependencies:</p>
  <div class="sourceCode" id="cb98"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> dep vim</span></code></pre></div>
  <p>Show recursive dependencies:</p>
  <div class="sourceCode" id="cb99"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> dep vim <span class="at">--recursive</span></span></code></pre></div>
  <p>Show detailed dependency tree:</p>
  <div class="sourceCode" id="cb100"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> dep vim <span class="at">--recursive</span> <span class="at">--tree</span></span></code></pre></div>
  <h4 data-number="4.6.1.5" id="build-and-install-packages"><span
  class="header-section-number">4.6.1.5</span> Build and Install
  Packages</h4>
  <p>Build and install a package with dependencies (recommended):</p>
  <div class="sourceCode" id="cb101"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">--deps</span> <span class="at">--group</span> xterm</span></code></pre></div>
  <p>Use <code>--group</code> to stop installation if a dependency
  fails. Retry failed installations:</p>
  <div class="sourceCode" id="cb102"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">--deps</span> <span class="at">--group</span> <span class="at">--force</span> xterm</span></code></pre></div>
  <p><code>--force</code> skips already installed packages during the
  retry.</p>
  <h4 data-number="4.6.1.6" id="update-installed-packages"><span
  class="header-section-number">4.6.1.6</span> Update Installed
  Packages</h4>
  <p>Identify outdated packages:</p>
  <div class="sourceCode" id="cb103"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> diff <span class="at">--deps</span> <span class="at">--full</span></span></code></pre></div>
  <p>Update a single package:</p>
  <div class="sourceCode" id="cb104"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> update <span class="at">--deps</span> <span class="at">--group</span> bind</span></code></pre></div>
  <p>Upgrade all packages in the system:</p>
  <div class="sourceCode" id="cb105"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> sysup <span class="at">--deps</span> <span class="at">--depsort</span> <span class="at">--group</span></span></code></pre></div>
  <h3 data-number="4.6.2" id="configuring-pkgman"><span
  class="header-section-number">4.6.2</span> Configuring pkgman</h3>
  <p><code>pkgman(1)</code> is configured via
  <code>/etc/pkgman.conf</code>. Key settings:</p>
  <ul>
  <li><p><code>pkgsrcdir</code>: Defines directories for package source
  collections (you can list multiple). The <code>pkgsrc-core</code>
  collection is enabled by default. See <a
  href="#collections">Collections</a> for additional collections.</p>
  <p>Details about <code>pkgsrcdir</code> and how it is used to
  configure <strong>Collections</strong> and
  <strong>Repositories</strong> are explored in next chapter: <a
  href="#package-sources-and-collections">PACKAGE SOURCES AND
  COLLECTIONS</a>.</p></li>
  <li><p><code>runscripts</code>: Enables <code>pre-install</code>,
  <code>post-install</code>, <code>pre-remove</code>, and
  <code>post-remove</code> scripts during operations. <strong>Enable
  this option.</strong></p></li>
  <li><p><code>logfile</code>: Specifies the log file for
  <code>pkgman(8)</code> operations.</p></li>
  </ul>
  <p>See <code>pkgman.conf(5)</code> for more details.</p>
  <h2 data-number="4.7" id="the-essentials-outro"><span
  class="header-section-number">4.7</span> The Essentials (outro)</h2>
  <p>This chapter introduced Zeppe-Lin’s tools for managing individual
  packages and basic system updates.</p>
  <p>In the next chapter, <strong>Collections</strong> of
  <strong>Package Sources</strong> are introduced — a modular approach
  to organizing and managing software — with <code>pkgman</code> serving
  as the central orchestration tool.</p>
  <hr />
  <h1 data-number="5" id="package-sources-and-collections"><span
  class="header-section-number">5</span> PACKAGE SOURCES AND
  COLLECTIONS</h1>
  <h2 data-number="5.1" id="introduction-2"><span
  class="header-section-number">5.1</span> Introduction</h2>
  <p>Zeppe-Lin organizes software sources into three key components:</p>
  <ul>
  <li><p><strong>Package Sources</strong>: Self-contained directories
  that include all files and instructions needed to build and install
  software. These are the foundation of Zeppe-Lin’s software
  management.</p></li>
  <li><p><strong>Collections</strong>: Logical groupings of
  <strong>Package Sources</strong>, organized by purpose (e.g., core,
  system tools, desktop applications). <strong>Collections</strong>
  simplify software organization and provide modularity.</p></li>
  <li><p><strong>Repositories</strong>: Distributed storage systems that
  host one or more <strong>Collections</strong>.
  <strong>Repositories</strong> enable versioning, collaboration, and
  synchronization across systems.</p></li>
  </ul>
  <p>These components provide a structured approach to building,
  managing, and distributing software on Zeppe-Lin. Tools like
  <code>pkgmk(8)</code> and <code>pkgman(1)</code> are used to interact
  with these components, supporting workflows such as dependency
  management, package building, and system updates.</p>
  <h2 data-number="5.2" id="organizing-package-sources"><span
  class="header-section-number">5.2</span> Organizing Package
  Sources</h2>
  <h3 data-number="5.2.1" id="package-source-the-core-unit"><span
  class="header-section-number">5.2.1</span> Package Source: The Core
  Unit</h3>
  <p>In Zeppe-Lin, a <strong>Package Source</strong> is the fundamental
  unit for building software. Each one represents a single application,
  library, or utility, organized as a directory with all the necessary
  files to build and install the software.</p>
  <p>Essential files include:</p>
  <ul>
  <li><p><code>Pkgfile</code>: The main build script. It defines the
  package’s metadata (name, version, dependencies) and includes the
  steps for downloading, compiling, and packaging the software using
  <code>pkgmk(8)</code>.</p>
  <p>See <code>pkgmk.Pkgfile(5)</code> for details.</p></li>
  <li><p><code>.md5sum</code>: This file contains checksums for
  verifying the integrity of downloaded source files. It ensures that
  the files have not been altered or corrupted during transfer.</p>
  <p>See <code>pkgmk.md5sum(5)</code> for details.</p></li>
  <li><p><code>.footprint</code>: Used for build verification, it lists
  the files expected in the final package. This helps maintain
  consistency in builds.</p>
  <p>See <code>pkgmk.footprint(5)</code> for details.</p></li>
  </ul>
  <p>Some <strong>Package Sources</strong> may include additional files
  to support custom builds or configurations:</p>
  <ul>
  <li><p><code>.32bit</code>: Flag file to trigger 32-bit build mode in
  <code>pkgmk(8)</code>.</p>
  <p>See <code>pkgmk.32bit(5)</code> for details.</p></li>
  <li><p><code>.nostrip</code>: Exceptions for stripping executable
  binaries and libraries.</p>
  <p>See <code>pkgmk.nostrip(5)</code> for details.</p></li>
  <li><p>Patch files (<code>*.patch</code>): Modify the source code
  before building.</p></li>
  <li><p>Configuration files for scheduled tasks (<code>cron.*</code>):
  Useful for automating processes.</p></li>
  <li><p>Scripts for managing services (<code>rc.*</code>): Enable or
  disable services automatically.</p>
  <p>See <code>rc.d(7)</code> for details.</p></li>
  <li><p>PAM configuration files (<code>pam.*</code>): Handle user
  authentication.</p></li>
  </ul>
  <p>Together, these files create a self-contained environment for
  building and managing software.</p>
  <h3 data-number="5.2.2" id="collections"><span
  class="header-section-number">5.2.2</span> Collections</h3>
  <p><strong>Collections</strong> are logical groupings of
  <strong>Package Sources</strong>. A <strong>Collection</strong> is
  simply a directory containing multiple <strong>Package
  Sources</strong> with a shared purpose, like system utilities or
  desktop applications.</p>
  <p>Example <strong>Collection</strong> structure:</p>
  <pre><code>Collection (e.g., pkgsrc-core)
|
|-- acl/ (Package Source)
|   |-- Pkgfile
|   |-- .md5sum
|   `-- .footprint
|
|-- bash/ (Package Source)
|   |-- Pkgfile
|   |-- .md5sum
|   `-- .footprint
|
`-- ... (more Package Sources)</code></pre>
  <p>This logical organization enables modular software management.
  Instead of dealing with individual packages in isolation,
  <strong>Collections</strong> provide a structured approach to grouping
  and managing related sets of software.</p>
  <p>Common <strong>Collections</strong> in Zeppe-Lin:</p>
  <ul>
  <li><code>pkgsrc-core</code>: Core packages for a minimal system.</li>
  <li><code>pkgsrc-system</code>: Utilities and system-specific
  tools.</li>
  <li><code>pkgsrc-xorg</code>: X Window System and related tools.</li>
  <li><code>pkgsrc-desktop</code>: Desktop applications.</li>
  </ul>
  <p>These <strong>Collections</strong> form the foundation of
  Zeppe-Lin’s software ecosystem, allowing users to selectively enable
  the software they need.</p>
  <h3 data-number="5.2.3"
  id="repositories-distributing-and-versioning-collections"><span
  class="header-section-number">5.2.3</span> Repositories: Distributing
  and Versioning Collections</h3>
  <p><strong>Collections</strong> are organized into
  <strong>Repositories</strong>, hosted on systems like Git. It’s
  important to note that while a repository <strong>can</strong> contain
  multiple collections, Zeppe-Lin’s official repositories adopt a
  strategy where each repository primarily focuses on a single
  collection. This design choice is driven by the benefits of allowing
  users to selectively clone only the collections they need.
  <strong>Repositories</strong> provide:</p>
  <ul>
  <li><p><strong>Versioning</strong>: Branches manage package sources
  for specific Zeppe-Lin releases (e.g., <code>1.x</code>,
  <code>2.x</code>), ensuring compatibility.</p></li>
  <li><p><strong>Distribution</strong>: Users can clone repositories to
  access collections and package sources.</p></li>
  </ul>
  <p>The official Zeppe-Lin repositories, following this
  one-collection-per-repository approach, include:</p>
  <ul>
  <li><code>pkgsrc-core.git</code>: Core packages for a minimal
  system.</li>
  <li><code>pkgsrc-system.git</code>: Utilities and system-specific
  tools.</li>
  <li><code>pkgsrc-xorg.git</code>: X Window System and related
  tools.</li>
  <li><code>pkgsrc-desktop.git</code>: Desktop applications.</li>
  </ul>
  <p><strong>Repositories</strong> ensure that collections are both
  modular and manageable, allowing users to selectively clone only the
  collections they need.</p>
  <h2 data-number="5.3" id="managing-package-sources"><span
  class="header-section-number">5.3</span> Managing Package Sources</h2>
  <h3 data-number="5.3.1" id="setting-up-collections"><span
  class="header-section-number">5.3.1</span> Setting Up Collections</h3>
  <p>To access software for installation in Zeppe-Lin, download the
  official package source collections and enable them for
  <code>pkgman(1)</code>.</p>
  <h4 data-number="5.3.1.1" id="syncing-official-repositories"><span
  class="header-section-number">5.3.1.1</span> Syncing Official
  Repositories</h4>
  <p>Clone the repositories from the Zeppe-Lin GitHub account:</p>
  <div class="sourceCode" id="cb107"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /usr/src/</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="va">URL</span><span class="op">=</span>https://github.com/zeppe-lin</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone <span class="va">${URL}</span>/pkgsrc-core    <span class="at">--branch</span> 1.x</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone <span class="va">${URL}</span>/pkgsrc-system  <span class="at">--branch</span> 1.x</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone <span class="va">${URL}</span>/pkgsrc-xorg    <span class="at">--branch</span> 1.x</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone <span class="va">${URL}</span>/pkgsrc-desktop <span class="at">--branch</span> 1.x</span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>The <code>1.x</code> branch applies to all <strong>1.</strong>
  releases (1.0, 1.1, 1.2, …). When a new major line appears, switch to
  its branch (e.g., <code>2.x</code>). Verify your release against the
  <a href="index.html#current-release">current release</a> or the <a
  href="https://github.com/zeppe-lin/pkgsrc-core/releases/latest">pkgsrc-core
  releases page</a>.</p>
  </blockquote>
  <h4 data-number="5.3.1.2"
  id="enabling-collections-in-pkgman.conf"><span
  class="header-section-number">5.3.1.2</span> Enabling Collections in
  pkgman.conf</h4>
  <p>Edit <code>/etc/pkgman.conf</code> to enable package sources
  collections. For example:</p>
  <pre><code>pkgsrcdir /usr/src/pkgsrc-core
pkgsrcdir /usr/src/pkgsrc-system
pkgsrcdir /usr/src/pkgsrc-xorg
pkgsrcdir /usr/src/pkgsrc-desktop</code></pre>
  <p>For detailed configuration options, see
  <code>pkgman.conf(5)</code>.</p>
  <h4 data-number="5.3.1.3" id="verify-your-setup"><span
  class="header-section-number">5.3.1.3</span> Verify Your Setup</h4>
  <p>Confirm that <code>pkgman(1)</code> recognizes the collections:</p>
  <div class="sourceCode" id="cb109"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> list <span class="at">--all</span></span></code></pre></div>
  <p>This lists all package sources from enabled collections.</p>
  <h3 data-number="5.3.2" id="exploring-and-installing-packages"><span
  class="header-section-number">5.3.2</span> Exploring and Installing
  Packages</h3>
  <p>With collections enabled, you can explore and install packages
  using <code>pkgman(1)</code>.</p>
  <h4 data-number="5.3.2.1" id="listing-available-packages"><span
  class="header-section-number">5.3.2.1</span> Listing Available
  Packages</h4>
  <p>List all package sources:</p>
  <div class="sourceCode" id="cb110"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> list <span class="at">--all</span></span></code></pre></div>
  <p>Example output:</p>
  <pre><code>-- list ([i] = installed)
[i] acl
[i] bash
[ ] vim
[ ] zathura
...</code></pre>
  <p>Legend:</p>
  <ul>
  <li><code>[i]</code>: The package is already installed.</li>
  <li><code>[ ]</code>: The package is available but not installed.</li>
  </ul>
  <p>To display the full path of each package source (helpful for
  identifying which collection a package belongs to), use the
  <code>--path</code> option:</p>
  <div class="sourceCode" id="cb112"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> list <span class="at">--all</span> <span class="at">--path</span></span></code></pre></div>
  <p>Example output:</p>
  <pre><code>[i] /usr/src/pkgsrc-core/acl
[ ] /usr/src/pkgsrc-system/vim</code></pre>
  <h4 data-number="5.3.2.2" id="searching-for-packages"><span
  class="header-section-number">5.3.2.2</span> Searching for
  Packages</h4>
  <p>If you’re looking for specific software, use the
  <code>search</code> command. For example, to search for packages
  related to <code>alsa</code>:</p>
  <pre><code>$ pkgman search alsa
-- search ([i] = installed)
[ ] alsa-lib
[ ] alsa-ucm-conf
[i] alsa-utils</code></pre>
  <p>The output indicates which packages are installed and
  available.</p>
  <p>For a detailed search that includes versions, descriptions, and
  collection paths, add the <code>-vv</code> and <code>--path</code>
  options:</p>
  <pre><code>$ pkgman search -vv --path alsa
-- search ([i] = installed)
[ ] /usr/src/pkgsrc-system/alsa-lib 1.2.15.1-1: ALSA libraries
[ ] /usr/src/pkgsrc-system/alsa-ucm-conf 1.2.15.1-1: ALSA Use Case Manager configuration
[i] /usr/src/pkgsrc-system/alsa-utils 1.2.15.1-1: Utilities for the ALSA</code></pre>
  <h4 data-number="5.3.2.3" id="building-and-installing-packages"><span
  class="header-section-number">5.3.2.3</span> Building and Installing
  Packages</h4>
  <p>Build and install a package with dependencies:</p>
  <div class="sourceCode" id="cb116"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">--deps</span> <span class="at">--group</span> <span class="op">&lt;</span>package_name<span class="op">&gt;</span></span></code></pre></div>
  <p>Example:</p>
  <div class="sourceCode" id="cb117"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">--deps</span> <span class="at">--group</span> vim</span></code></pre></div>
  <p>Build and install multiple packages:</p>
  <div class="sourceCode" id="cb118"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">--deps</span> <span class="at">--group</span> vim zathura</span></code></pre></div>
  <p>For verbose output (show building process on stdout):</p>
  <div class="sourceCode" id="cb119"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">-vv</span> <span class="at">--deps</span> <span class="at">--group</span> vim zathura</span></code></pre></div>
  <p>Dry run:</p>
  <div class="sourceCode" id="cb120"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">-vv</span> <span class="at">--test</span> <span class="at">--deps</span> <span class="at">--group</span> vim zathura</span></code></pre></div>
  <blockquote>
  <p><strong>Tip:</strong></p>
  <p>Use <code>pkgman search</code> to locate package names.</p>
  </blockquote>
  <p>Run <code>pkgman install --help</code> or see
  <code>pkgman-install(8)</code> for information about all installation
  options.</p>
  <h3 data-number="5.3.3" id="keeping-your-system-up-to-date"><span
  class="header-section-number">5.3.3</span> Keeping Your System
  Up-to-Date</h3>
  <p>Maintaining your Zeppe-Lin system involves two primary tasks:</p>
  <ol type="1">
  <li>Sync your <strong>Repositories</strong> regularly to stay
  up-to-date.</li>
  <li>Updating installed packages to their latest versions.</li>
  </ol>
  <h4 data-number="5.3.3.1" id="synchronizing-local-collections"><span
  class="header-section-number">5.3.3.1</span> Synchronizing Local
  Collections</h4>
  <p>Regularly sync local collections with remote repositories using
  <code>git pull</code>:</p>
  <div class="sourceCode" id="cb121"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> <span class="at">-C</span> /usr/src/pkgsrc-core     pull</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> <span class="at">-C</span> /usr/src/pkgsrc-system   pull</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> <span class="at">-C</span> /usr/src/pkgsrc-xorg     pull</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> <span class="at">-C</span> /usr/src/pkgsrc-desktop  pull</span></code></pre></div>
  <p>Include unofficial collections if applicable.</p>
  <p>Automate Syncing: Set up a cron job with <code>crond(8)</code>:</p>
  <pre class="crontab"><code># Weekly sync at 3:00 AM on Sundays
0 3 * * 0 run-one git -C /usr/src/pkgsrc-core    pull -q
0 3 * * 0 run-one git -C /usr/src/pkgsrc-system  pull -q
0 3 * * 0 run-one git -C /usr/src/pkgsrc-xorg    pull -q
0 3 * * 0 run-one git -C /usr/src/pkgsrc-desktop pull -q</code></pre>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>Ensure <code>run-one</code> package from <code>pkgsrc-core</code>
  collection is installed.</p>
  </blockquote>
  <h4 data-number="5.3.3.2" id="checking-for-package-updates"><span
  class="header-section-number">5.3.3.2</span> Checking for Package
  Updates</h4>
  <p>Once the local collections are synced, identify outdated packages
  with <code>pkgman diff</code>:</p>
  <div class="sourceCode" id="cb123"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> diff <span class="at">--deps</span> <span class="at">--full</span></span></code></pre></div>
  <p>Example output:</p>
  <pre><code>-- Differences between installed packages and packages sources tree
Package         Installed      Available
feh             3.7.2-1        3.7.2-2
screen          4.9.0-1        5.0.0-1
...

-- Packages not found in the packages sources tree
Package         Installed      Required by
libncurses      6.2-1          vim</code></pre>
  <p>Review this output to determine which packages need updates.
  Packages in the “not found” section may have been removed from the
  collection or installed manually from other sources.</p>
  <h4 data-number="5.3.3.3" id="updating-packages"><span
  class="header-section-number">5.3.3.3</span> Updating Packages</h4>
  <p>To upgrade the system, start by downloading all required source
  files. This ensures the upgrade won’t be interrupted by missing
  files.</p>
  <div class="sourceCode" id="cb125"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> sysup <span class="at">-do</span></span></code></pre></div>
  <p>Once the sources are downloaded, upgrade the packages with proper
  dependency handling and ordering:</p>
  <div class="sourceCode" id="cb126"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> sysup <span class="at">--deps</span> <span class="at">--depsort</span> <span class="at">--group</span></span></code></pre></div>
  <p>Options explained:</p>
  <ul>
  <li><p><code>--deps</code><br />
  Include all dependencies of the packages in the update
  process.</p></li>
  <li><p><code>--depsort</code><br />
  Sort packages by dependency order before updating.</p></li>
  <li><p><code>--group</code><br />
  Update all packages in order, stopping immediately if the update of
  any package fails. Useful for updating dependent packages
  sequentially.</p></li>
  </ul>
  <h4 data-number="5.3.3.4" id="updating-specific-packages"><span
  class="header-section-number">5.3.3.4</span> Updating Specific
  Packages</h4>
  <p>Update individual packages with <code>pkgman update</code>. For
  example:</p>
  <div class="sourceCode" id="cb127"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> update <span class="at">--deps</span> <span class="at">--depsort</span> <span class="at">--group</span> screen feh</span></code></pre></div>
  <p>This command updates only the specified packages while resolving
  their dependencies.</p>
  <h3 data-number="5.3.4" id="advanced-package-management"><span
  class="header-section-number">5.3.4</span> Advanced Package
  Management</h3>
  <h4 data-number="5.3.4.1"
  id="detecting-broken-dependencies-with-revdep1"><span
  class="header-section-number">5.3.4.1</span> Detecting Broken
  Dependencies with revdep(1)</h4>
  <p><code>revdep(1)</code> checks installed packages for missing or
  incorrect shared libraries. Use it to verify system stability and
  identify packages needing a rebuild after updates.</p>
  <p>Check system-wide for broken libraries:</p>
  <div class="sourceCode" id="cb128"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="ex">revdep</span></span></code></pre></div>
  <p>Rebuild affected packages:</p>
  <div class="sourceCode" id="cb129"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> update <span class="at">-fr</span> <span class="va">$(</span><span class="ex">revdep</span><span class="va">)</span></span></code></pre></div>
  <p>Inspect a specific package:</p>
  <div class="sourceCode" id="cb130"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="ex">revdep</span> <span class="at">-p</span> bash</span></code></pre></div>
  <p>Run <code>revdep</code> regularly after updates or repository syncs
  to ensure all packages remain functional.</p>
  <p>See <code>revdep(1)</code> and <code>revdep.d(5)</code> for more
  information.</p>
  <h4 data-number="5.3.4.2" id="ignoring-packages-during-updates"><span
  class="header-section-number">5.3.4.2</span> Ignoring Packages During
  Updates</h4>
  <p>Prevent updates to specific packages during system upgrades with
  <code>--ignore</code>. Example:</p>
  <div class="sourceCode" id="cb131"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> sysup <span class="at">--deps</span> <span class="at">--depsort</span> <span class="at">--group</span> <span class="at">--ignore</span><span class="op">=</span>linux,linux-firmware</span></code></pre></div>
  <p>Regularly revisit ignored packages to avoid security risks and
  dependency conflicts.</p>
  <h4 data-number="5.3.4.3" id="locking-packages"><span
  class="header-section-number">5.3.4.3</span> Locking Packages</h4>
  <p>Lock a package to prevent upgrades indefinitely:</p>
  <div class="sourceCode" id="cb132"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> lock linux</span></code></pre></div>
  <p>Unlock a package to resume updates:</p>
  <div class="sourceCode" id="cb133"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> unlock linux</span></code></pre></div>
  <p>Locked packages are useful for maintaining specific software
  versions critical to workflows.</p>
  <p>See <code>pkgman-lock(8)</code>, <code>pkgman-unlock(8)</code>, and
  <code>pkgman-list-locked(1)</code> for more information.</p>
  <h4 data-number="5.3.4.4" id="handling-lower-available-versions"><span
  class="header-section-number">5.3.4.4</span> Handling Lower Available
  Versions</h4>
  <p>Occasionally, a package source may revert to a lower version than
  the one installed on your system. This often happens when maintainers
  roll back to a stable release after issues with a newer version. By
  default, <code>pkgman</code> does not prioritize installed versions
  over available ones.</p>
  <p>To override this behavior, enable the <code>preferhigher</code>
  option:</p>
  <div class="sourceCode" id="cb134"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> <span class="at">--config-set</span><span class="op">=</span><span class="st">&quot;preferhigher yes&quot;</span> sysup <span class="at">--deps</span> <span class="at">--depsort</span></span></code></pre></div>
  <p>This ensures <code>pkgman</code> retains the higher installed
  version during upgrades. Use this feature cautiously, as higher
  versions might be less stable or unsupported.</p>
  <h4 data-number="5.3.4.5" id="practical-considerations"><span
  class="header-section-number">5.3.4.5</span> Practical
  Considerations</h4>
  <ul>
  <li><p>Regularly review ignored and locked packages for security and
  compatibility.</p></li>
  <li><p>Avoid using <code>preferhigher</code> without understanding the
  implications of using potentially unstable software.</p></li>
  <li><p>Check dependency trees carefully to prevent system
  breakages.</p></li>
  </ul>
  <h2 data-number="5.4" id="extending-software-sources"><span
  class="header-section-number">5.4</span> Extending Software
  Sources</h2>
  <h3 data-number="5.4.1" id="adding-a-local-collection"><span
  class="header-section-number">5.4.1</span> Adding a Local
  Collection</h3>
  <p>This section explains how to create custom collections. A local
  collection allows you to add new packages that are not available in
  the official repositories.</p>
  <h4 data-number="5.4.1.1" id="creating-the-collection-directory"><span
  class="header-section-number">5.4.1.1</span> Creating the Collection
  Directory</h4>
  <p>Create your local collection directory in <code>/usr/src</code>,
  alongside official Zeppe-Lin collections. Using directories with
  broader read permissions ensures that unprivileged users like
  <code>pkgmk</code> can access the collection.</p>
  <p>Example:</p>
  <div class="sourceCode" id="cb135"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /usr/src</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> mynewcollection</span></code></pre></div>
  <h4 data-number="5.4.1.2"
  id="enabling-the-collection-in-pkgman.conf"><span
  class="header-section-number">5.4.1.2</span> Enabling the Collection
  in pkgman.conf</h4>
  <p>Add your collection to <code>/etc/pkgman.conf</code>. List it above
  official collections to give it search priority:</p>
  <pre><code>pkgsrcdir /usr/src/mynewcollection
pkgsrcdir /usr/src/pkgsrc-core
pkgsrcdir /usr/src/pkgsrc-system
pkgsrcdir /usr/src/pkgsrc-xorg</code></pre>
  <p>Save the file and proceed to verify the setup.</p>
  <h4 data-number="5.4.1.3" id="verifying-the-collection-setup"><span
  class="header-section-number">5.4.1.3</span> Verifying the Collection
  Setup</h4>
  <p>Verify that <code>pkgman(1)</code> recognizes your collection:</p>
  <div class="sourceCode" id="cb137"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> dumpconfig</span></code></pre></div>
  <p>Check the “Packages sources directories” section for your
  collection:</p>
  <pre><code>Packages sources directories: &lt;n&gt;
  /usr/src/mynewcollection &lt;-- here
  /usr/src/pkgsrc-core
  /usr/src/pkgsrc-system
  /usr/src/pkgsrc-xorg
  ...</code></pre>
  <p>If it appears, the setup is complete, and you can start adding
  package sources.</p>
  <h3 data-number="5.4.2" id="creating-custom-packages"><span
  class="header-section-number">5.4.2</span> Creating Custom
  Packages</h3>
  <p>After setting up your local collection, the next step is to add a
  package source. This involves creating a directory for the package and
  writing a <code>Pkgfile</code> with build instructions and
  metadata.</p>
  <h4 data-number="5.4.2.1" id="creating-the-package-directory"><span
  class="header-section-number">5.4.2.1</span> Creating the Package
  Directory</h4>
  <p>Create a subdirectory for the new package in your local collection.
  Ensure the directory name matches the package name in the
  <code>Pkgfile</code>:</p>
  <pre><code># mkdir /usr/src/mynewcollection/hello
# cd /usr/src/mynewcollection/hello</code></pre>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>Naming consistency is critical. A mismatch between the directory
  name and <code>name</code> in the <code>Pkgfile</code> cause build
  error.</p>
  </blockquote>
  <h4 data-number="5.4.2.2" id="writing-the-pkgfile"><span
  class="header-section-number">5.4.2.2</span> Writing the Pkgfile</h4>
  <p>The <code>Pkgfile</code> serves two purposes:</p>
  <ol type="1">
  <li>Provides build instructions for <code>pkgmk(8)</code>.</li>
  <li>Supplies metadata for <code>pkgman(1)</code> to enable dependency
  resolution, search, and queries.</li>
  </ol>
  <p>Example <code>Pkgfile</code>:</p>
  <div class="sourceCode" id="cb140"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Description: Example package based on GNU hello</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="co"># URL:         https://www.gnu.org/software/hello/</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Depends on:  glibc</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="va">name</span><span class="op">=</span>hello</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="va">version</span><span class="op">=</span>2.12.1</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="va">release</span><span class="op">=</span>1</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="va">source</span><span class="op">=</span>https://ftp.gnu.org/gnu/hello/<span class="va">$name</span>-<span class="va">$version</span>.tar.gz</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="fu">build()</span> <span class="kw">{</span></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">cd</span> <span class="va">$name</span>-<span class="va">$version</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>        <span class="ex">./configure</span> <span class="at">--prefix</span><span class="op">=</span>/usr <span class="at">--disable-nls</span></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">make</span> V=1</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">make</span> DESTDIR=<span class="va">$PKG</span> install</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rm</span> <span class="at">-rf</span> <span class="va">$PKG</span>/usr/share/info</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
  <h4 data-number="5.4.2.3" id="key-metadata-headers-for-pkgman"><span
  class="header-section-number">5.4.2.3</span> Key Metadata Headers for
  pkgman</h4>
  <p>Include these headers in the <code>Pkgfile</code> for optimal
  integration with <code>pkgman(1)</code>:</p>
  <ul>
  <li><p><code># Description</code><br />
  Brief summary of the package.</p></li>
  <li><p><code># URL</code><br />
  Link to official documentation or website.</p></li>
  <li><p><code># Depends on</code><br />
  List of dependencies. <code>pkgman(1)</code> resolves and installs
  these automatically.</p></li>
  </ul>
  <blockquote>
  <p><strong>Important:</strong><br />
  Without these headers, <code>pkgman(1)</code> cannot display metadata
  or resolve dependencies.</p>
  </blockquote>
  <h4 data-number="5.4.2.4" id="verifying-the-package-source"><span
  class="header-section-number">5.4.2.4</span> Verifying the Package
  Source</h4>
  <p>Verify your package metadata with:</p>
  <pre><code>$ pkgman info hello
Name:         hello
Path:         /usr/src/mynewcollection/hello
Version:      2.12.1
Release:      1
Description:  Example package based on GNU hello
URL:          https://www.gnu.org/software/hello/
Depends on:   glibc</code></pre>
  <p>If metadata is missing, review the <code>Pkgfile</code> for
  errors.</p>
  <h3 data-number="5.4.3"
  id="building-and-installing-custom-packages"><span
  class="header-section-number">5.4.3</span> Building and Installing
  Custom Packages</h3>
  <p>After creating a custom package source, the next step is to build
  and install the package using <code>pkgman(1)</code> and
  <code>pkgmk(8)</code>, addressing any potential permission issues.</p>
  <h4 data-number="5.4.3.1" id="building-the-package"><span
  class="header-section-number">5.4.3.1</span> Building the Package</h4>
  <p>Build your custom package with:</p>
  <div class="sourceCode" id="cb142"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> install <span class="at">-vv</span> <span class="at">--deps</span> hello</span></code></pre></div>
  <p>This command:</p>
  <ol type="1">
  <li>Downloads source files if not cached.</li>
  <li>Builds the package using <code>pkgmk(8)</code>.</li>
  <li>Installs the package with <code>pkgadd(8)</code>.</li>
  </ol>
  <blockquote>
  <p><strong>Note:</strong></p>
  <p>Warnings about missing <code>.md5sum</code> and
  <code>.footprint</code> files like
  <code>/usr/bin/pkgmk: ... cannot create .md5sum: Permission denied</code>
  occur because packages are built with the unprivileged
  <code>pkgmk</code> user, which has not write permissions in
  <code>/usr/src/mynewcollection</code>.</p>
  </blockquote>
  <h4 data-number="5.4.3.2"
  id="resolving-permissions-for-build-files"><span
  class="header-section-number">5.4.3.2</span> Resolving Permissions for
  Build Files</h4>
  <p>There are at least two options to resolve permissions case.</p>
  <ol type="1">
  <li><p><strong>Manually Updating Files.</strong></p>
  <p>Navigate to the package directory and generate the files:</p>
  <div class="sourceCode" id="cb143"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /usr/src/mynewcollection/hello</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgmk</span> <span class="at">-um</span>   <span class="co"># Update .md5sum</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgmk</span> <span class="at">-uf</span>   <span class="co"># Update .footprint</span></span></code></pre></div></li>
  <li><p><strong>Adjusting Permissions.</strong></p>
  <p>Grant write access to <code>pkgmk</code> using
  <code>setfacl(1)</code>:</p>
  <div class="sourceCode" id="cb144"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="ex">setfacl</span> <span class="at">-m</span> u:pkgmk:rwx /usr/src/mynewcollection/hello</span></code></pre></div>
  <p>Rebuild the package afterward:</p>
  <div class="sourceCode" id="cb145"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> update <span class="at">-fr</span> hello</span></code></pre></div></li>
  </ol>
  <h4 data-number="5.4.3.3" id="verifying-generated-files"><span
  class="header-section-number">5.4.3.3</span> Verifying Generated
  Files</h4>
  <p>After addressing warnings, confirm the presence of required
  files:</p>
  <pre><code>$ ls -l /usr/src/mynewcollection/hello
-rw-r--r--  1 pkgmk pkgmk  251 .footprint
-rw-r--r--  1 pkgmk pkgmk   54 .md5sum
-rw-r--r--  1 root  root   359 Pkgfile</code></pre>
  <h4 data-number="5.4.3.4" id="verifying-the-installation"><span
  class="header-section-number">5.4.3.4</span> Verifying the
  Installation</h4>
  <p>Ensure the package is installed on your system:</p>
  <pre><code>$ pkgman isinst hello
package &#39;hello&#39; is installed</code></pre>
  <p>Run:</p>
  <pre><code>$ hello
Hello, world!</code></pre>
  <h3 data-number="5.4.4"
  id="building-packages-from-bleeding-edge-sources"><span
  class="header-section-number">5.4.4</span> Building Packages from
  Bleeding-Edge Sources</h3>
  <p>Some packages need to be built directly from version control
  systems (VCS) like Git or Subversion, instead of fixed release
  archives. This section outlines two approaches: a stable approach and
  a bleeding-edge approach.</p>
  <h4 data-number="5.4.4.1" id="stable-commit-approach"><span
  class="header-section-number">5.4.4.1</span> Stable Commit
  Approach</h4>
  <p>For production, pinning to a specific commit ensures consistent
  builds. Example:</p>
  <div class="sourceCode" id="cb149"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Description: Ratpoison window manager</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co"># URL:         https://www.nongnu.org/ratpoison/</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Depends on:  xorg-server</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="va">name</span><span class="op">=</span>ratpoison</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="va">version</span><span class="op">=</span>1.4.9-db94d49  <span class="co"># Release + commit hash</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="va">release</span><span class="op">=</span>1</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom function to fetch or clone git repository</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a><span class="fu">download_git()</span> <span class="kw">{</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-d</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">git</span> <span class="at">-C</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span> fetch <span class="at">--depth</span><span class="op">=</span>1</span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">git</span> <span class="at">-C</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span> clean <span class="at">-f</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">git</span> <span class="at">-C</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span> reset <span class="at">--hard</span> origin/<span class="va">$2</span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">git</span> <span class="at">-C</span> <span class="va">$PKGMK_SOURCE_DIR</span> clone <span class="at">--depth</span><span class="op">=</span>1 <span class="va">$1</span> <span class="at">-b</span> <span class="va">$2</span> <span class="va">$name</span></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cp</span> <span class="at">-r</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span> <span class="va">$PKGMK_WORK_DIR</span>/src/<span class="va">$name</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a><span class="fu">build()</span> <span class="kw">{</span></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a>    <span class="ex">download_git</span> https://git.savannah.nongnu.org/git/ratpoison.git master</span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">cd</span> ratpoison</span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">git</span> checkout <span class="va">${version</span><span class="op">#</span><span class="pp">*</span>-<span class="va">}</span>  <span class="co"># Pin commit &#39;db94d49&#39;</span></span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a>    <span class="ex">./configure</span> <span class="at">--prefix</span><span class="op">=</span>/usr</span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make</span> V=1</span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make</span> DESTDIR=<span class="va">$PKG</span> install</span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
  <p>Pinning builds guarantees stability and shields against upstream
  changes.</p>
  <h4 data-number="5.4.4.2" id="bleeding-edge-approach"><span
  class="header-section-number">5.4.4.2</span> Bleeding-Edge
  Approach</h4>
  <p>For testing, dynamically set the version to the current date
  (<code>YYYYMMDD</code>) to track upstream changes. Example:</p>
  <div class="sourceCode" id="cb150"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Description: Ruby interpreter (bleeding-edge)</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co"># URL:         http://www.ruby-lang.org</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Depends on:  gdbm libgmp openssl zlib libffi libyaml</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="va">name</span><span class="op">=</span>ruby-scm</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="va">version</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> +%Y%m%d<span class="va">)</span>  <span class="co"># Version updates daily to track build date</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="va">release</span><span class="op">=</span>1</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a><span class="fu">download_git()</span> <span class="kw">{</span></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-d</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">git</span> <span class="at">-C</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span> fetch <span class="at">--depth</span><span class="op">=</span>1</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">git</span> <span class="at">-C</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span> clean <span class="at">-f</span></span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">git</span> <span class="at">-C</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span> reset <span class="at">--hard</span> origin/<span class="va">$2</span></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">git</span> <span class="at">-C</span> <span class="va">$PKGMK_SOURCE_DIR</span> clone <span class="at">--depth</span><span class="op">=</span>1 <span class="va">$1</span> <span class="at">-b</span> <span class="va">$2</span> <span class="va">$name</span></span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cp</span> <span class="at">-r</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span> <span class="va">$PKGMK_WORK_DIR</span>/src/<span class="va">$name</span></span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a><span class="fu">build()</span> <span class="kw">{</span></span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a>    <span class="ex">download_git</span> https://github.com/ruby/ruby master</span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">cd</span> ruby-scm</span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a>    <span class="ex">./configure</span> <span class="at">--prefix</span><span class="op">=</span>/usr</span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make</span> V=1</span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make</span> DESTDIR=<span class="va">$PKG</span> install</span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
  <p><strong>“Daily Updates”</strong>: If the installed version is
  outdated, <code>pkgman(1)</code> flags it during
  <code>pkgman diff</code>, prompting updates:</p>
  <div class="sourceCode" id="cb151"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> diff</span></code></pre></div>
  <p>Expected output:</p>
  <pre><code>-- Differences between installed packages and packages sources tree
ruby-scm                        20250216-1          20250401-1</code></pre>
  <p>This approach is ideal for development but unsuitable for
  production environments.</p>
  <h4 data-number="5.4.4.3"
  id="subversion-repository-download-function"><span
  class="header-section-number">5.4.4.3</span> Subversion Repository
  Download Function</h4>
  <p>For Subversion-based builds, use a download function like this:</p>
  <div class="sourceCode" id="cb153"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">download_svn()</span> <span class="kw">{</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-d</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">svn</span> cleanup <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">svn</span> up <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">svn</span> co <span class="va">$1</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cp</span> <span class="at">-r</span> <span class="va">$PKGMK_SOURCE_DIR</span>/<span class="va">$name</span> <span class="va">$PKGMK_WORK_DIR</span>/src/<span class="va">$name</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span></code></pre></div>
  <p>Example usage in a <code>Pkgfile</code>:</p>
  <div class="sourceCode" id="cb154"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="ex">download_svn</span> https://svn.project.org/svn/program/trunk</span></code></pre></div>
  <p>Add <code>subversion</code> to dependencies for compatibility.
  Unlike <code>git</code>, which resides in <code>pkgsrc-core</code>,
  <code>subversion</code> requires explicit declaration.</p>
  <h4 data-number="5.4.4.4" id="best-practices"><span
  class="header-section-number">5.4.4.4</span> Best Practices</h4>
  <ul>
  <li>Use pinned commits or snapshots for stability in production.</li>
  <li>Reserve bleeding-edge builds for testing and development.</li>
  <li>Include download functions (<code>download_git</code> or
  <code>download_svn</code>) directly in <code>Pkgfile</code> for
  portability.</li>
  </ul>
  <h2 data-number="5.5" id="tips-and-best-practices"><span
  class="header-section-number">5.5</span> Tips and Best Practices</h2>
  <h3 data-number="5.5.1" id="renicing-builds"><span
  class="header-section-number">5.5.1</span> Renicing Builds</h3>
  <p>Package builds can reduce system responsiveness due to high CPU and
  I/O usage. Mitigate this by adjusting process priorities using
  <code>nice(1)</code> and <code>ionice(1)</code>:</p>
  <ul>
  <li><code>nice(1)</code>: Lowers CPU priority (higher number = lower
  priority).</li>
  <li><code>ionice(1)</code>: Adjusts I/O priority (class 2, priority 6
  is commonly used).</li>
  </ul>
  <p>Update the <code>makecommand</code> in
  <code>/etc/pkgman.conf</code>:</p>
  <pre><code>makecommand sudo -H -u pkgmk nice -n10 ionice -c2 -n6 fakeroot pkgmk</code></pre>
  <p>Explanation:</p>
  <ul>
  <li><code>nice -n10</code>: Reduces CPU priority (10 = relatively
  low).</li>
  <li><code>ionice -c2 -n6</code>: Reduces I/O priority (class 2,
  priority 6).</li>
  </ul>
  <p>These changes help the build process interfere less with
  interactive tasks, improving system responsiveness.</p>
  <h3 data-number="5.5.2"
  id="ram-builds-for-faster-package-compilation"><span
  class="header-section-number">5.5.2</span> RAM Builds for Faster
  Package Compilation</h3>
  <p>Using RAM for temporary build files (<code>tmpfs</code>) can
  significantly speed up package compilation in Zeppe-Lin.</p>
  <h4 data-number="5.5.2.1" id="enable-ram-builds-in-zeppe-lin"><span
  class="header-section-number">5.5.2.1</span> Enable RAM Builds in
  Zeppe-Lin</h4>
  <ol type="1">
  <li><p>Uncomment this line in <code>/etc/fstab</code>:</p>
  <pre><code>pkgmk /var/cache/pkgmk/work tmpfs size=&lt;SIZE&gt;,uid=&lt;UID&gt;,defaults 0 0</code></pre>
  <p>Replace <code>SIZE</code> (e.g., <code>16G</code>). The
  <code>UID</code> for the <code>pkgmk</code> user is
  preconfigured.</p></li>
  <li><p>Mount <code>tmpfs</code>:</p>
  <div class="sourceCode" id="cb157"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> pkgmk</span></code></pre></div></li>
  <li><p>Remove <code>-pipe</code> from <code>CFLAGS</code> and
  <code>CXXFLAGS</code> in <code>/etc/pkgmk.conf</code>.</p></li>
  </ol>
  <h4 data-number="5.5.2.2"
  id="ram-build-configuration-educational"><span
  class="header-section-number">5.5.2.2</span> RAM Build Configuration
  (Educational)</h4>
  <p>For users interested in customizing the setup:</p>
  <ol type="1">
  <li><p>Creating a dedicated build user:</p>
  <div class="sourceCode" id="cb158"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="ex">useradd</span> <span class="at">-b</span> /var/cache/ <span class="at">-m</span> <span class="at">-s</span> /bin/false <span class="at">-U</span> pkgmk</span></code></pre></div></li>
  <li><p>Setting up build directories and assigning ownership:</p>
  <div class="sourceCode" id="cb159"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> /var/cache/pkgmk/<span class="dt">{sources</span><span class="op">,</span><span class="dt">packages</span><span class="op">,</span><span class="dt">work}</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chown</span> <span class="at">-R</span> pkgmk:pkgmk /var/cache/pkgmk/<span class="dt">{sources</span><span class="op">,</span><span class="dt">packages</span><span class="op">,</span><span class="dt">work}</span></span></code></pre></div></li>
  <li><p>Configuring <code>tmpfs</code> in <code>/etc/fstab</code>:</p>
  <pre><code>pkgmk /var/cache/pkgmk/work tmpfs size=&lt;SIZE&gt;,uid=&lt;UID&gt;,defaults 0 0</code></pre></li>
  <li><p>Setting the work directory in <code>/etc/pkgmk.conf</code>:</p>
  <div class="sourceCode" id="cb161"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="va">PKGMK_WORK_DIR</span><span class="op">=</span><span class="st">&quot;/var/cache/pkgmk/work/</span><span class="va">$name</span><span class="st">&quot;</span></span></code></pre></div></li>
  <li><p>Removing <code>-pipe</code> from <code>CFLAGS</code> and
  <code>CXXFLAGS</code> in <code>/etc/pkgmk.conf</code>.</p></li>
  </ol>
  <h3 data-number="5.5.3" id="unprivileged-builds-in-zeppe-lin"><span
  class="header-section-number">5.5.3</span> Unprivileged Builds in
  Zeppe-Lin</h3>
  <p>Zeppe-Lin builds packages as an unprivileged user (typically
  <code>pkgmk</code>) by default. This secure and modular setup isolates
  the build process to mitigate risks. <strong>If you are using
  Zeppe-Lin, these steps are already configured out of the box.</strong>
  <strong>There is no need to repeat them.</strong></p>
  <p>However, this guide is provided for educational purposes, to show
  how it was achieved, or for users wanting to adapt this approach for
  other distributions or customizations.</p>
  <ol type="1">
  <li><p>Create a Dedicated Build User. A restricted user is used to
  perform package builds securely:</p>
  <div class="sourceCode" id="cb162"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="ex">useradd</span> <span class="at">-b</span> /var/cache/ <span class="at">-m</span> <span class="at">-s</span> /bin/false <span class="at">-U</span> pkgmk</span></code></pre></div>
  <p>This creates a user and group named <code>pkgmk</code> with limited
  shell access.</p></li>
  <li><p>Set Up Build Directories. Directories for sources, packages,
  and temporary files are created and assigned ownership to the
  <code>pkgmk</code> user:</p>
  <div class="sourceCode" id="cb163"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> /var/cache/pkgmk/<span class="dt">{sources</span><span class="op">,</span><span class="dt">packages</span><span class="op">,</span><span class="dt">work}</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chown</span> <span class="at">-R</span> pkgmk:pkgmk /var/cache/pkgmk/<span class="dt">{sources</span><span class="op">,</span><span class="dt">packages</span><span class="op">,</span><span class="dt">work}</span></span></code></pre></div></li>
  <li><p>Configure <code>pkgmk</code>. In <code>/etc/pkgmk.conf</code>,
  the paths for these directories are defined:</p>
  <div class="sourceCode" id="cb164"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="va">PKGMK_SOURCE_DIR</span><span class="op">=</span><span class="st">&quot;/var/cache/pkgmk/sources&quot;</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="va">PKGMK_PACKAGE_DIR</span><span class="op">=</span><span class="st">&quot;/var/cache/pkgmk/packages&quot;</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="va">PKGMK_WORK_DIR</span><span class="op">=</span><span class="st">&quot;/var/cache/pkgmk/work/</span><span class="va">$name</span><span class="st">-</span><span class="va">$$</span><span class="st">&quot;</span></span></code></pre></div></li>
  <li><p>Integrate <code>pkgman</code>. In
  <code>/etc/pkgman.conf</code>, the <code>makecommand</code> variable
  is updated to run <code>pkgmk(8)</code> as the unprivileged
  <code>pkgmk</code> user via <code>sudo(8)</code> and
  <code>fakeroot(1)</code>:</p>
  <pre><code>makecommand sudo -H -u pkgmk fakeroot pkgmk</code></pre></li>
  </ol>
  <p>This structure ensures package builds are securely isolated while
  remaining flexible for adaptations.</p>
  <hr />
  <h1 data-number="6" id="configuration"><span
  class="header-section-number">6</span> CONFIGURATION</h1>
  <h2 data-number="6.1" id="generating-locales"><span
  class="header-section-number">6.1</span> Generating Locales</h2>
  <p>In Zeppe-Lin, <code>glibc</code> package includes a minimal set of
  locales by default, with <code>C.UTF-8</code> generated for
  compatibility with <code>pkgmk(8)</code>. To create additional
  locales, replace <code>en_US</code> with your desired locale and
  run:</p>
  <div class="sourceCode" id="cb166"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="ex">localedef</span> <span class="at">-i</span> en_US <span class="at">-f</span> UTF-8 en_US.UTF-8</span></code></pre></div>
  <p>Set the system default locale by adding it to
  <code>/etc/profile</code>:</p>
  <div class="sourceCode" id="cb167"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">LANG</span><span class="op">=</span>en_US.UTF-8</span></code></pre></div>
  <p>This ensures consistent locale settings across your system.</p>
  <h2 data-number="6.2"
  id="system-initialization-and-configuration"><span
  class="header-section-number">6.2</span> System Initialization and
  Configuration</h2>
  <p>Zeppe-Lin uses a lightweight BSD-style init system to manage
  startup, services, and shutdown. This system relies on shell scripts
  located in <code>/etc</code> and <code>/etc/rc.d</code>, offering an
  efficient and flexible way to control processes.</p>
  <h3 data-number="6.2.1" id="system-states-runlevels"><span
  class="header-section-number">6.2.1</span> System States
  (Runlevels)</h3>
  <p>Runlevels define the operating state of the system, such as
  halting, rebooting, or normal operation. Zeppe-Lin’s runlevels are
  configured in <code>/etc/inittab</code>:</p>
  <table>
  <colgroup>
  <col style="width: 12%" />
  <col style="width: 24%" />
  <col style="width: 63%" />
  </colgroup>
  <thead>
  <tr>
  <th>Runlevel</th>
  <th>State</th>
  <th>Purpose</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td>0</td>
  <td>Halt</td>
  <td>Shut down the system completely</td>
  </tr>
  <tr>
  <td>1 (S)</td>
  <td>Single-User Mode</td>
  <td>Maintenance mode with minimal setup</td>
  </tr>
  <tr>
  <td>2</td>
  <td>Multi-User Mode</td>
  <td>Full system operation with multiple users</td>
  </tr>
  <tr>
  <td>3-5</td>
  <td>Unused</td>
  <td>Reserved for custom use</td>
  </tr>
  <tr>
  <td>6</td>
  <td>Reboot</td>
  <td>Restart the system</td>
  </tr>
  </tbody>
  </table>
  <p>By default, Zeppe-Lin boots into multi-user mode (runlevel
  <strong>2</strong>), which enables all services and user access.
  Single-user mode (runlevel <strong>1</strong> or <strong>S</strong>)
  is ideal for system maintenance, providing a minimal environment.</p>
  <h3 data-number="6.2.2" id="core-init-scripts"><span
  class="header-section-number">6.2.2</span> Core Init Scripts</h3>
  <p>Zeppe-Lin’s init system uses the following scripts to manage system
  processes:</p>
  <table>
  <colgroup>
  <col style="width: 19%" />
  <col style="width: 80%" />
  </colgroup>
  <thead>
  <tr>
  <th>File/Directory</th>
  <th>Purpose</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td>/etc/rc</td>
  <td>Main system boot script, invoked by <code>init(8)</code></td>
  </tr>
  <tr>
  <td>/etc/rc.modules</td>
  <td>Kernel module initialization, invoked by <code>/etc/rc</code></td>
  </tr>
  <tr>
  <td>/etc/rc.single</td>
  <td>Single-user mode script for maintenance tasks</td>
  </tr>
  <tr>
  <td>/etc/rc.multi</td>
  <td>Multi-user mode script for normal operation</td>
  </tr>
  <tr>
  <td>/etc/rc.local</td>
  <td>Custom commands executed after <code>/etc/rc.multi</code> during
  normal boot</td>
  </tr>
  <tr>
  <td>/etc/rc.d</td>
  <td>Directory containing scripts to control individual services</td>
  </tr>
  <tr>
  <td>/etc/rc.shutdown</td>
  <td>Script invoked by <code>shutdown(8)</code> to gracefully stop
  services</td>
  </tr>
  </tbody>
  </table>
  <p>Customize system behavior by modifying <code>/etc/rc.local</code>
  for personal commands or <code>/etc/rc.modules</code> to load specific
  kernel modules.</p>
  <p>See <code>rc(8)</code> for details.</p>
  <h3 data-number="6.2.3"
  id="configuring-runlevels-and-init-behavior"><span
  class="header-section-number">6.2.3</span> Configuring Runlevels and
  Init Behavior</h3>
  <p>The <code>/etc/inittab</code> file determines actions for each
  runlevel. Each entry follows this format:
  <code>id:runlevel:action:command</code></p>
  <p>Key Components:</p>
  <ul>
  <li><code>id</code>: Unique entry identifier.</li>
  <li><code>runlevel</code>: Runlevels the command applies to.</li>
  <li><code>action</code>: Specifies when the command runs (e.g., on
  boot, shutdown).</li>
  <li><code>command</code>: The script or program to execute.</li>
  </ul>
  <p>Example <code>/etc/inittab</code> Configuration:</p>
  <div class="sourceCode" id="cb168"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set default runlevel to multi-user mode</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="ex">id:2:initdefault:</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Core startup scripts</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="ex">rc::sysinit:/etc/rc</span>         <span class="co"># Main boot script</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="ex">rs:S1:wait:/etc/rc.single</span>   <span class="co"># Single-user mode startup</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="ex">rm:2:wait:/etc/rc.multi</span>     <span class="co"># Multi-user mode startup</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="ex">rd:06:wait:/etc/rc.shutdown</span> <span class="co"># Graceful shutdown</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Virtual console login prompts</span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="ex">c1:2:respawn:/sbin/agetty</span> <span class="at">--noclear</span> 38400 tty1 linux</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a><span class="ex">c2:2:respawn:/sbin/agetty</span> 38400 tty2 linux</span></code></pre></div>
  <p>This configuration ensures a smooth startup, runtime, and shutdown
  process. See <code>inittab(5)</code> for configuration details.</p>
  <h3 data-number="6.2.4"
  id="configuring-system-behavior-etcrc.conf"><span
  class="header-section-number">6.2.4</span> Configuring System Behavior
  (/etc/rc.conf)</h3>
  <p>The <code>/etc/rc.conf</code> file centralizes system configuration
  settings, such as hostname, timezone, and services. Example:</p>
  <div class="sourceCode" id="cb169"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="va">HOSTNAME</span><span class="op">=</span><span class="st">&quot;myhostname&quot;</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="va">TIMEZONE</span><span class="op">=</span><span class="st">&quot;Europe/Berlin&quot;</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICES</span><span class="op">=</span><span class="st">&quot;lo crond sshd&quot;</span></span></code></pre></div>
  <p>Services listed in <code>SERVICES</code> correspond to scripts in
  <code>/etc/rc.d/</code>, which are started by
  <code>/etc/rc.multi</code> and stopped by
  <code>/etc/rc.shutdown</code> (in reverse order).</p>
  <p>See <code>rc.conf(5)</code> for additional configuration
  settings.</p>
  <h3 data-number="6.2.5" id="service-control-scripts-etcrc.d"><span
  class="header-section-number">6.2.5</span> Service Control Scripts
  (/etc/rc.d/)</h3>
  <p>The <code>/etc/rc.d/</code> directory contains individual scripts
  to manage services. Each script supports commands like:</p>
  <ul>
  <li><code>start</code>: Activate the service.</li>
  <li><code>stop</code>: Terminates the service.</li>
  <li><code>restart</code>: Stop and then start the service.</li>
  <li><code>status</code>: Check if the service is running.</li>
  </ul>
  <p>Example usage:</p>
  <div class="sourceCode" id="cb170"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/etc/rc.d/sshd</span> start</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="ex">/etc/rc.d/sshd</span> status</span></code></pre></div>
  <p>See <code>rc.d(7)</code> for more information.</p>
  <h3 data-number="6.2.6"
  id="kernel-module-management-etcrc.modules"><span
  class="header-section-number">6.2.6</span> Kernel Module Management
  (/etc/rc.modules)</h3>
  <p>The <code>/etc/rc.modules</code> script is used to initialize
  kernel modules at boot. It begins by running
  <code>/sbin/depmod -a</code> to refresh the module dependency map,
  ensuring correct load order.</p>
  <p>After this, <code>rc.modules</code> delegates to the standalone
  <code>modules-load(8)</code> utility. This utility reads configuration
  files from the following directories:</p>
  <ul>
  <li><code>/etc/modules-load.d</code> — administrator overrides</li>
  <li><code>/run/modules-load.d</code> — runtime configuration</li>
  <li><code>/lib/modules-load.d</code> — vendor defaults</li>
  </ul>
  <p>Files must end with <code>.conf</code> and contain one module name
  per line. Empty lines and lines beginning with <code>#</code> are
  ignored. An empty or comment-only file in
  <code>/etc/modules-load.d</code> disables vendor or runtime lists of
  the same name.</p>
  <p>Example configuration file
  <code>/etc/modules-load.d/virtio.conf</code>:</p>
  <div class="sourceCode" id="cb171"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load virtio drivers at boot</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="ex">virtio-net</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="ex">virtio-blk</span></span></code></pre></div>
  <blockquote>
  <p><strong>Note:</strong><br />
  For the design reasoning behind <code>modules-load</code> and its
  configuration directories, see <a
  href="https://github.com/zeppe-lin/modules-load/blob/master/RATIONALE.md">RATIONALE.md</a>
  in the source tree.</p>
  </blockquote>
  <p>For modules requiring parameters, configure them in
  <code>/etc/modprobe.d/</code> for persistent management.<br />
  For example, to set options for the <code>snd_hda_intel</code> module,
  create <code>/etc/modprobe.d/snd_hda_intel.conf</code>:</p>
  <div class="sourceCode" id="cb172"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: limit snd_hda_intel probing to a specific device</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (probe_mask is hardware-dependent; 8 is only an example)</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="ex">options</span> snd_hda_intel probe_mask=8</span></code></pre></div>
  <p>This ensures parameters are automatically applied whenever the
  module is loaded, avoiding manual specification and following best
  practice.</p>
  <p>Custom one-off module commands may still be added directly to
  <code>/etc/rc.modules</code> after the <code>modules-load</code> call,
  e.g.:</p>
  <div class="sourceCode" id="cb173"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: load loopback block device support at boot</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/sbin/modprobe</span> loop</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: force-load Intel HDA sound driver at boot</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (normally auto-loaded; shown here for illustration)</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="ex">/sbin/modprobe</span> snd_hda_intel</span></code></pre></div>
  <p>The <code>/etc/rc.modules</code> script itself is invoked by
  <code>/etc/rc</code> during the boot process.</p>
  <h3 data-number="6.2.7" id="custom-startup-commands-etcrc.local"><span
  class="header-section-number">6.2.7</span> Custom Startup Commands
  (/etc/rc.local)</h3>
  <p>User-defined actions are added to <code>/etc/rc.local</code>,
  executed as last step of a normal boot (invoked by
  <code>/etc/rc.multi</code>). Example:</p>
  <div class="sourceCode" id="cb174"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start a monitoring app</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/usr/bin/my_monitoring_app</span> <span class="kw">&amp;</span></span></code></pre></div>
  <h3 data-number="6.2.8"
  id="from-boot-to-login-system-startup-sequence"><span
  class="header-section-number">6.2.8</span> From Boot to Login: System
  Startup Sequence</h3>
  <p>Here’s the sequence from power-up to login. It differs slightly
  with or without <code>initramfs</code>.</p>
  <h4 data-number="6.2.8.1" id="without-initramfs"><span
  class="header-section-number">6.2.8.1</span> Without Initramfs</h4>
  <ol type="1">
  <li>Power On: System starts.</li>
  <li>Bootloader: Loads the kernel into memory.</li>
  <li>Kernel starts: Initializes hardware and memory.</li>
  <li><code>/sbin/init</code> starts: The first user-space process (PID
  1).</li>
  <li><code>/etc/inittab</code> is read: <code>init</code> gets its
  instructions.</li>
  <li><code>/etc/rc</code> runs: The main boot script executes.</li>
  <li>Runlevel is set: The default runlevel (usually <strong>2</strong>)
  is chosen.</li>
  <li><code>/etc/rc.multi</code> starts services: Services from
  <code>/etc/rc.conf</code> are launched.</li>
  <li><code>/etc/rc.local</code> runs: Your custom commands are
  executed.</li>
  <li>Login prompts: The system is ready for you.</li>
  </ol>
  <h4 data-number="6.2.8.2" id="with-initramfs"><span
  class="header-section-number">6.2.8.2</span> With Initramfs</h4>
  <ol type="1">
  <li>Power On: System starts.</li>
  <li>Bootloader: Loads kernel and initramfs into memory.</li>
  <li>Kernel starts: Initializes basic hardware.</li>
  <li><code>initramfs</code> mounts: A temporary root filesystem in
  RAM.</li>
  <li><code>/init</code> from <code>initramfs</code> runs: Performs
  early setup (e.g., storage drivers).</li>
  <li>Real root mounts: Your main filesystem is mounted.</li>
  <li>Root is switched: System moves from initramfs to your real
  root.</li>
  <li><code>/sbin/init</code> on real root starts: The init process from
  your main system.</li>
  <li><em>(Steps 5-10 from <a href="#without-initramfs">Without
  Initramfs</a> follow).</em></li>
  </ol>
  <h3 data-number="6.2.9" id="minimal-mode-single-user-mode"><span
  class="header-section-number">6.2.9</span> Minimal Mode (Single-User
  Mode)</h3>
  <p>Runlevel <strong>1</strong> or <strong>S</strong> boots the system
  with a minimal setup for maintenance. It runs
  <code>/etc/rc.single</code>, providing a root shell for
  troubleshooting.</p>
  <h3 data-number="6.2.10" id="graceful-shutdown-procedure"><span
  class="header-section-number">6.2.10</span> Graceful Shutdown
  Procedure</h3>
  <p>When shutting down or rebooting, <code>/etc/rc.shutdown</code> is
  invoked to stop services, unmount filesystems, and safely power off
  the system.</p>
  <h2 data-number="6.3" id="networking"><span
  class="header-section-number">6.3</span> Networking</h2>
  <h3 data-number="6.3.1" id="hostname-configuration"><span
  class="header-section-number">6.3.1</span> Hostname Configuration</h3>
  <p>The hostname identifies your system on the network.</p>
  <p>To set it temporarily, use:</p>
  <div class="sourceCode" id="cb175"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hostname</span> <span class="op">&lt;</span>new_hostname<span class="op">&gt;</span></span></code></pre></div>
  <p>For a permanent setting, edit <code>/etc/rc.conf</code> and
  set:</p>
  <div class="sourceCode" id="cb176"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="va">HOSTNAME</span><span class="op">=</span><span class="st">&#39;&lt;new_hostname&gt;&#39;</span></span></code></pre></div>
  <p>For proper network function, edit <code>/etc/hosts</code> and add
  your hostname to the loopback lines:</p>
  <pre><code>127.0.0.1 localhost &lt;new_hostname&gt;
::1       localhost &lt;new_hostname&gt;</code></pre>
  <p>This ensures your system recognizes its own name.</p>
  <h3 data-number="6.3.2" id="static-address"><span
  class="header-section-number">6.3.2</span> Static Address</h3>
  <p>To configure a static IP, edit <code>/etc/rc.d/net</code>. Set the
  network interface, IP, subnet mask, and gateway. For example:</p>
  <div class="sourceCode" id="cb178"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="va">DEV</span><span class="op">=</span>enp11s0</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="va">ADDR</span><span class="op">=</span>192.168.1.100</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="va">MASK</span><span class="op">=</span>24</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="va">GW</span><span class="op">=</span>192.168.1.1</span></code></pre></div>
  <p>Set DNS in <code>/etc/resolv.conf</code>:</p>
  <pre><code>search &lt;your internal domain&gt;
nameserver &lt;your DNS server&gt;</code></pre>
  <p>Start, stop or restart the service via:</p>
  <div class="sourceCode" id="cb180"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/etc/rc.d/net</span> {start<span class="kw">|</span><span class="ex">stop</span><span class="kw">|</span><span class="ex">restart}</span></span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>To auto-start service at boot, add <code>net</code> to the
  <code>SERVICES</code> line in <code>/etc/rc.conf</code>.</p>
  </blockquote>
  <h3 data-number="6.3.3" id="dynamic-address"><span
  class="header-section-number">6.3.3</span> Dynamic Address</h3>
  <p>To get an IP address automatically via DHCP, install the
  <code>dhcpcd</code> package and edit <code>/etc/rc.d/dhcpcd</code> to
  specify the network interface (e.g., <code>enp5s0</code>):</p>
  <div class="sourceCode" id="cb181"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="va">DEV</span><span class="op">=</span>enp5s0</span></code></pre></div>
  <p>Start, stop, or restart the service via:</p>
  <div class="sourceCode" id="cb182"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/etc/rc.d/dhcpcd</span> {start<span class="kw">|</span><span class="ex">stop</span><span class="kw">|</span><span class="ex">restart}</span></span></code></pre></div>
  <p>Check <code>dhcpcd</code>’s README for potential issues:</p>
  <div class="sourceCode" id="cb183"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pkgman</span> readme dhcpcd</span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>To auto-start service at boot, add <code>dhcpcd</code> to the
  <code>SERVICES</code> line in <code>/etc/rc.conf</code>.</p>
  </blockquote>
  <h3 data-number="6.3.4" id="wireless-network"><span
  class="header-section-number">6.3.4</span> Wireless Network</h3>
  <p>Ensure the wireless interface isn’t blocked. Use
  <code>rfkill(8)</code>:</p>
  <div class="sourceCode" id="cb184"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="ex">rfkill</span> list</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="ex">rfkill</span> unblock <span class="op">&lt;</span>ID<span class="kw">|</span><span class="ex">TYPE</span><span class="op">&gt;</span></span></code></pre></div>
  <p>Install the <code>wpa-supplicant</code> package and edit
  <code>/etc/rc.d/wpa_supplicant</code> to set the wireless
  interface:</p>
  <div class="sourceCode" id="cb185"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="va">DEV</span><span class="op">=</span>wlp1s0</span></code></pre></div>
  <p>Update <code>/etc/wpa_supplicant.conf</code> based on your network
  settings. Common security configurations follow.</p>
  <h4 data-number="6.3.4.1" id="wpa-psk-pre-shared-key"><span
  class="header-section-number">6.3.4.1</span> WPA-PSK (Pre-Shared
  Key)</h4>
  <p>Generate a key with <code>wpa_passphrase(8)</code>:</p>
  <div class="sourceCode" id="cb186"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="ex">wpa_passphrase</span> <span class="op">&lt;</span>MYSSID<span class="op">&gt;</span> <span class="op">&lt;</span>PASSPHRASE<span class="op">&gt;</span></span></code></pre></div>
  <p>Example <code>/etc/wpa_supplicant.conf</code>:</p>
  <pre><code>network={
    ssid=&quot;YOUR_NETWORK_NAME&quot;
    psk=&quot;THE_GENERATED_KEY&quot;
}</code></pre>
  <h4 data-number="6.3.4.2" id="wpa-eap-enterprise"><span
  class="header-section-number">6.3.4.2</span> WPA-EAP (Enterprise)</h4>
  <p>Generate a password hash:</p>
  <div class="sourceCode" id="cb188"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="op">&lt;</span>PASSPHRASE<span class="op">&gt;</span> <span class="kw">|</span> <span class="fu">iconv</span> <span class="at">-t</span> utf16le <span class="kw">|</span> <span class="ex">openssl</span> md4</span></code></pre></div>
  <p>Example <code>/etc/wpa_supplicant.conf</code>:</p>
  <pre><code>network={
    ssid=&quot;YOUR_NETWORK_NAME&quot;
    key_mgmt=WPA-EAP
    identity=&quot;YOUR_USERNAME&quot;
    password=hash:&lt;YOUR_PASSWORD_HASH&gt;
}</code></pre>
  <h4 data-number="6.3.4.3" id="wep"><span
  class="header-section-number">6.3.4.3</span> WEP</h4>
  <p>Example <code>/etc/wpa_supplicant.conf</code> for WEP:</p>
  <pre><code>network={
    ssid=&quot;YOUR_NETWORK_NAME&quot;
    key_mgmt=NONE
    wep_key0=&quot;YOUR_WEP_KEY&quot;
    wep_tx_keyidx=0
    auth_alg=SHARED
}</code></pre>
  <p>For automatic IP, ensure the wireless interface is set in
  <code>/etc/rc.d/dhcpcd</code>. Start the services:</p>
  <div class="sourceCode" id="cb191"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/etc/rc.d/wpa_supplicant</span> start</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="ex">/etc/rc.d/dhcpcd</span> start</span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>To auto-start service at boot, add <code>wpa_supplicant</code> (and
  <code>dhcpcd</code> if using dynamic IP) to the <code>SERVICES</code>
  line in <code>/etc/rc.conf</code>.</p>
  </blockquote>
  <h3 data-number="6.3.5" id="bridge-networking"><span
  class="header-section-number">6.3.5</span> Bridge Networking</h3>
  <p>A bridge allows you to connect a physical interface with virtual
  interfaces so they share the same network. This is commonly used for
  virtualization (e.g., QEMU).</p>
  <h4 data-number="6.3.5.1" id="bridge-interface"><span
  class="header-section-number">6.3.5.1</span> Bridge Interface</h4>
  <p>Create <code>/etc/rc.d/bridge</code> to manage the bridge and
  physical device:</p>
  <div class="sourceCode" id="cb192"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="co"># /etc/rc.d/bridge: start/stop bridge interface</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="va">DEV</span><span class="op">=</span>eth0</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="va">BRIDGE</span><span class="op">=</span>br0</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="va">$1</span> <span class="kw">in</span></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a><span class="ss">start</span><span class="kw">)</span></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> link add name <span class="va">$BRIDGE</span> type bridge</span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> link set <span class="va">$BRIDGE</span> up</span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> addr flush dev <span class="va">$DEV</span></span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> link set <span class="va">$DEV</span> up</span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> link set <span class="va">$DEV</span> master <span class="va">$BRIDGE</span></span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">;;</span></span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a><span class="ss">stop</span><span class="kw">)</span></span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> link set <span class="va">$DEV</span> nomaster</span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> link set <span class="va">$DEV</span> down</span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> link delete <span class="va">$BRIDGE</span> type bridge</span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">;;</span></span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a><span class="ss">restart</span><span class="kw">)</span></span>
<span id="cb192-23"><a href="#cb192-23" aria-hidden="true" tabindex="-1"></a>    <span class="va">$0</span> stop</span>
<span id="cb192-24"><a href="#cb192-24" aria-hidden="true" tabindex="-1"></a>    <span class="va">$0</span> start</span>
<span id="cb192-25"><a href="#cb192-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">;;</span></span>
<span id="cb192-26"><a href="#cb192-26" aria-hidden="true" tabindex="-1"></a><span class="ss">status</span><span class="kw">)</span></span>
<span id="cb192-27"><a href="#cb192-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Status not applicable: no persistent service&quot;</span></span>
<span id="cb192-28"><a href="#cb192-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">;;</span></span>
<span id="cb192-29"><a href="#cb192-29" aria-hidden="true" tabindex="-1"></a><span class="pp">*</span><span class="kw">)</span></span>
<span id="cb192-30"><a href="#cb192-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Usage: </span><span class="va">$0</span><span class="st"> {start|stop|restart|status}&quot;</span></span>
<span id="cb192-31"><a href="#cb192-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">;;</span></span>
<span id="cb192-32"><a href="#cb192-32" aria-hidden="true" tabindex="-1"></a><span class="cf">esac</span></span></code></pre></div>
  <p>Start, stop, or restart the service via:</p>
  <div class="sourceCode" id="cb193"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/etc/rc.d/bridge</span> {start<span class="kw">|</span><span class="ex">stop</span><span class="kw">|</span><span class="ex">restart}</span></span></code></pre></div>
  <blockquote>
  <p><strong>Note:</strong></p>
  <p>If your system requires kernel modules such as <code>bridge</code>,
  <code>tun</code>, <code>tap</code>, or <code>vhost</code>, list them
  in <code>/etc/modules-load.d/bridge.conf</code>, so they are loaded
  automatically at boot.</p>
  <p>Example:</p>
  <div class="sourceCode" id="cb194"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># /etc/modules-load.d/bridge.conf</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ethernet bridge driver</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="ex">bridge</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Universal TUN/TAP device driver</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a><span class="ex">tun</span></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a><span class="co"># TAP device driver</span></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a><span class="ex">tap</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Host kernel accelerator for virtio</span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a><span class="ex">vhost</span></span></code></pre></div>
  </blockquote>
  <h4 data-number="6.3.5.2" id="tap-interface"><span
  class="header-section-number">6.3.5.2</span> Tap Interface</h4>
  <p>A tap device provides a virtual interface for QEMU or other
  virtualization software. Attach it to the bridge to allow guest
  systems to communicate on the network.</p>
  <p>Create <code>/etc/rc.d/tap</code>:</p>
  <div class="sourceCode" id="cb195"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="co"># /etc/rc.d/tap: start/stop tap interface</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a><span class="va">TAP</span><span class="op">=</span>tap0</span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a><span class="va">USER</span><span class="op">=</span>username</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a><span class="va">GROUP</span><span class="op">=</span>username</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a><span class="va">BRIDGE</span><span class="op">=</span>br0</span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="va">$1</span> <span class="kw">in</span></span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a><span class="ss">start</span><span class="kw">)</span></span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> tuntap add mode tap user <span class="va">$USER</span> group <span class="va">$GROUP</span> <span class="va">$TAP</span></span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> link set <span class="va">$TAP</span> up</span>
<span id="cb195-15"><a href="#cb195-15" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> link set <span class="va">$TAP</span> master <span class="va">$BRIDGE</span></span>
<span id="cb195-16"><a href="#cb195-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">;;</span></span>
<span id="cb195-17"><a href="#cb195-17" aria-hidden="true" tabindex="-1"></a><span class="ss">stop</span><span class="kw">)</span></span>
<span id="cb195-18"><a href="#cb195-18" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> link set <span class="va">$TAP</span> nomaster</span>
<span id="cb195-19"><a href="#cb195-19" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> link set <span class="va">$TAP</span> down</span>
<span id="cb195-20"><a href="#cb195-20" aria-hidden="true" tabindex="-1"></a>    <span class="ex">/sbin/ip</span> tuntap del mode tap <span class="va">$TAP</span></span>
<span id="cb195-21"><a href="#cb195-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">;;</span></span>
<span id="cb195-22"><a href="#cb195-22" aria-hidden="true" tabindex="-1"></a><span class="ss">restart</span><span class="kw">)</span></span>
<span id="cb195-23"><a href="#cb195-23" aria-hidden="true" tabindex="-1"></a>    <span class="va">$0</span> stop</span>
<span id="cb195-24"><a href="#cb195-24" aria-hidden="true" tabindex="-1"></a>    <span class="va">$0</span> start</span>
<span id="cb195-25"><a href="#cb195-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">;;</span></span>
<span id="cb195-26"><a href="#cb195-26" aria-hidden="true" tabindex="-1"></a><span class="ss">status</span><span class="kw">)</span></span>
<span id="cb195-27"><a href="#cb195-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Status not applicable: no persistent service&quot;</span></span>
<span id="cb195-28"><a href="#cb195-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">;;</span></span>
<span id="cb195-29"><a href="#cb195-29" aria-hidden="true" tabindex="-1"></a><span class="pp">*</span><span class="kw">)</span></span>
<span id="cb195-30"><a href="#cb195-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Usage: </span><span class="va">$0</span><span class="st"> {start|stop|restart|status}&quot;</span></span>
<span id="cb195-31"><a href="#cb195-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">;;</span></span>
<span id="cb195-32"><a href="#cb195-32" aria-hidden="true" tabindex="-1"></a><span class="cf">esac</span></span></code></pre></div>
  <blockquote>
  <p><strong>Note:</strong></p>
  <p>The <code>USER</code> and <code>GROUP</code> variables define which
  system account owns the tap device. Set them to the user and group
  that will run QEMU or other virtualization software. This ensures
  proper permissions without needing root during guest startup.</p>
  </blockquote>
  <p>Start, stop, or restart the service via:</p>
  <div class="sourceCode" id="cb196"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/etc/rc.d/tap</span> {start<span class="kw">|</span><span class="ex">stop</span><span class="kw">|</span><span class="ex">restart}</span></span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong><br />
  To auto-start both bridge and tap services at boot, add them to the
  <code>SERVICES</code> line in <code>/etc/rc.conf</code>:</p>
  <div class="sourceCode" id="cb197"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICES</span><span class="op">=</span><span class="st">&quot;... net bridge tap&quot;</span></span></code></pre></div>
  </blockquote>
  <blockquote>
  <p><strong>Important:</strong><br />
  <code>/etc/rc.d/bridge</code> and <code>/etc/rc.d/tap</code> services
  are not part of the base system. Only configure them if you need
  virtualization networking. For basic networking, see <code>net</code>,
  <code>dhcpcd</code>, and/or <code>wpa_supplicant</code>.</p>
  </blockquote>
  <h2 data-number="6.4" id="time-and-date-configuration"><span
  class="header-section-number">6.4</span> Time and Date
  Configuration</h2>
  <h3 data-number="6.4.1" id="timezone-setup"><span
  class="header-section-number">6.4.1</span> Timezone Setup</h3>
  <p>Select your timezone from <code>/usr/share/zoneinfo</code> (e.g.,
  <code>Europe/Berlin</code>).</p>
  <p>Set the timezone immediately:</p>
  <div class="sourceCode" id="cb198"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-sfn</span> /usr/share/zoneinfo/Europe/Berlin /etc/localtime</span></code></pre></div>
  <p>To make it persistent, add the timezone to
  <code>/etc/rc.conf</code>:</p>
  <div class="sourceCode" id="cb199"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="va">TIMEZONE</span><span class="op">=</span><span class="st">&quot;Europe/Berlin&quot;</span></span></code></pre></div>
  <h3 data-number="6.4.2" id="system-clock-setup"><span
  class="header-section-number">6.4.2</span> System Clock Setup</h3>
  <p>Manually set the system clock using the
  <code>MMDDhhmmYYYY.ss</code> format:</p>
  <div class="sourceCode" id="cb200"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: March 27, 05:35, 2025</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span> 032705352025.00</span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>Manual configuration is temporary. Use NTP for continuous
  synchronization (described next).</p>
  </blockquote>
  <h3 data-number="6.4.3"
  id="network-time-protocol-ntp-configuration"><span
  class="header-section-number">6.4.3</span> Network Time Protocol (NTP)
  Configuration</h3>
  <blockquote>
  <p><strong>Note:</strong></p>
  <p>Accurate time via NTP is crucial for time-sensitive things like
  OTP.</p>
  </blockquote>
  <p>Use an NTP client, such as <code>chrony</code>, to synchronize the
  system clock.</p>
  <p>After installing <code>chrony</code>, start, stop, or restart the
  service via:</p>
  <div class="sourceCode" id="cb201"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as root</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="ex">/etc/rc.d/chrony</span> {start<span class="kw">|</span><span class="ex">stop</span><span class="kw">|</span><span class="ex">restart}</span></span></code></pre></div>
  <blockquote>
  <p><strong>Important:</strong></p>
  <p>To enable automatic startup, add <code>chrony</code> to the
  <code>SERVICES</code> line in <code>/etc/rc.conf</code>.</p>
  </blockquote>
  <h2 data-number="6.5" id="user-authentication-and-environment"><span
  class="header-section-number">6.5</span> User Authentication and
  Environment</h2>
  <p>This section explains Zeppe-Lin’s approach to user authentication,
  environment setup, and PAM (Pluggable Authentication Modules).</p>
  <h3 data-number="6.5.1" id="password-management"><span
  class="header-section-number">6.5.1</span> Password Management</h3>
  <p>Zeppe-Lin uses <code>libxcrypt</code> to provide the
  <code>crypt(3)</code> API for password hashing.</p>
  <p>The default hash algorithm is <strong>SHA-512</strong>, ensuring
  strong security. <strong>Legacy algorithms</strong> (MD5, traditional
  DES) are supported for compatibility, but their use is
  discouraged.</p>
  <p>Programs that authenticate users via <code>crypt(3)</code> must
  link against <code>libxcrypt</code> (<code>-lcrypt</code>).</p>
  <p>System-wide password policies are defined in
  <code>/etc/login.defs</code>. Key parameters include:</p>
  <ul>
  <li><code>PASS_MAX_DAYS</code> — Maximum password age.</li>
  <li><code>PASS_MIN_DAYS</code> — Minimum password age.</li>
  <li><code>PASS_WARN_AGE</code> — Days before expiration to warn
  users.</li>
  </ul>
  <p>Use <code>passwd(1)</code> to set or change user passwords. SHA-512
  is recommended for all accounts.</p>
  <h3 data-number="6.5.2" id="user-environment"><span
  class="header-section-number">6.5.2</span> User Environment</h3>
  <p>User accounts are created via <code>useradd(8)</code> according to
  <code>/etc/login.defs</code>.</p>
  <p>Home directories created with <code>useradd -m</code> are empty by
  default. To provide default files, use <code>/etc/skel</code>.</p>
  <p>The default shell <code>PATH</code> is defined in
  <code>/etc/profile</code>:</p>
  <div class="sourceCode" id="cb202"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/sbin:/usr/sbin:/bin:/usr/bin</span></span></code></pre></div>
  <p>This allows access to administrative commands without specifying
  full paths.</p>
  <h3 data-number="6.5.3"
  id="pluggable-authentication-modules-pam"><span
  class="header-section-number">6.5.3</span> Pluggable Authentication
  Modules (PAM)</h3>
  <p>Zeppe-Lin uses PAM for authentication, session management, and
  resource control.</p>
  <p>PAM configuration files are located in <code>/etc/pam.d</code>.
  Each file corresponds to a specific service (e.g., <code>login</code>,
  <code>su</code>, <code>sshd</code>). Key modules included:</p>
  <ul>
  <li><p><code>pam_dumb_runtime_dir.so</code><br />
  Creates <code>XDG_RUNTIME_DIR</code> on login. Required for Wayland,
  PipeWire, and other XDG-compliant environments.</p></li>
  <li><p><code>pam_env.so</code><br />
  Exports environment variables from
  <code>/etc/security/pam_env.conf</code> and
  <code>/etc/environment</code>, enabling system-wide settings for
  users.</p></li>
  <li><p><code>pam_limits.so</code><br />
  Enforces resource limits (max processes, open files) defined in
  <code>/etc/security/limits.conf</code>.</p></li>
  </ul>
  <p>For advanced configurations, consult module-specific man pages
  (e.g., <code>pam_dumb_runtime_dir(8)</code>, <code>pam_env(8)</code>,
  <code>pam_limits(8)</code>, <code>pam_exec(8)</code>).</p>
  <hr />
  <h1 data-number="7" id="appendices"><span
  class="header-section-number">7</span> APPENDICES</h1>
  <h2 data-number="7.1" id="appendix-a-licensing-legal"><span
  class="header-section-number">7.1</span> Appendix A: Licensing &amp;
  Legal</h2>
  <p>This appendix summarizes the licensing and legal terms applicable
  to Zeppe-Lin, including software components, build scripts, website
  content, and artwork.</p>
  <h3 data-number="7.1.1" id="software-packages"><span
  class="header-section-number">7.1.1</span> Software &amp;
  Packages</h3>
  <p>Zeppe-Lin is composed entirely of free and open-source software
  obtained from publicly available upstream projects.</p>
  <p>Each package retains its original upstream license (including GPL,
  BSD, MIT, Apache, and others). Zeppe-Lin does not relicense, restrict,
  or replace upstream licensing terms.</p>
  <p>The distributed root filesystem and any binary packages are built
  from these sources without the inclusion of proprietary software.
  Patches applied during the build process are limited to correctness,
  portability, or security fixes and do not alter licensing
  conditions.</p>
  <p>Redistribution and use of binaries are governed solely by the
  licenses of the upstream projects from which they originate.</p>
  <h3 data-number="7.1.2" id="build-scripts"><span
  class="header-section-number">7.1.2</span> Build Scripts</h3>
  <p>Build scripts and related tooling are derived from CRUX and
  extended by the Zeppe-Lin project.</p>
  <ul>
  <li>© 2000-2021 <a href="mailto:per@fukt.bth.se">Per Lidén</a> and the
  <a href="https://crux.nu">CRUX Team</a></li>
  <li>© 2022-2026 <a href="mailto:alexandr.savca89@gmail.com">Alexandr
  Savca</a> and <a href="https://github.com/zeppe-lin">Zeppe-Lin
  Team</a></li>
  </ul>
  <p>These scripts are licensed under the <a
  href="https://gnu.org/licenses/gpl.html">GNU General Public License
  version 3 or later (GPLv3+)</a>.</p>
  <h3 data-number="7.1.3" id="website-artwork"><span
  class="header-section-number">7.1.3</span> Website &amp; Artwork</h3>
  <p>Website content and visual assets, including documentation text,
  branding, and release artwork, are maintained by the Zeppe-Lin
  project.</p>
  <ul>
  <li>© 2022-2026 <a href="mailto:alexandr.savca89@gmail.com">Alexandr
  Savca</a> and <a href="https://github.com/zeppe-lin">Zeppe-Lin
  Team</a></li>
  </ul>
  <p>This material is licensed under the <a
  href="https://creativecommons.org/licenses/by-sa/3.0/">Creative
  Commons Attribution-ShareAlike 3.0 Unported License (CC-BY-SA
  3.0)</a>.</p>
  <p>This license applies only to website content and artwork. Source
  code, packages, and build scripts are governed by their respective
  licenses.</p>
  <p>Artwork repository: <a href="https://github.com/zeppe-lin/artwork"
  class="uri">https://github.com/zeppe-lin/artwork</a><br />
  Website repository: <a
  href="https://github.com/zeppe-lin/zeppe-lin.github.io/"
  class="uri">https://github.com/zeppe-lin/zeppe-lin.github.io/</a></p>
  <h3 data-number="7.1.4" id="disclaimer"><span
  class="header-section-number">7.1.4</span> Disclaimer</h3>
  <p>Zeppe-Lin is distributed in the hope that it will be useful, but
  WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. Use it at YOUR
  OWN RISK.</p>
  <h2 data-number="7.2" id="appendix-b-troubleshooting"><span
  class="header-section-number">7.2</span> Appendix B:
  Troubleshooting</h2>
  <p>This appendix collects solutions to common issues in Zeppe‑Lin.
  Topics are grouped by area for easier navigation.</p>
  <h3 data-number="7.2.1" id="dhcpcd-networking-issues"><span
  class="header-section-number">7.2.1</span> dhcpcd Networking
  Issues</h3>
  <h4 data-number="7.2.1.1" id="overview"><span
  class="header-section-number">7.2.1.1</span> Overview</h4>
  <p>Covers common problems with <code>dhcpcd</code>, including carrier
  loss, client ID mismatches, and noncompliant routers. Edit
  <code>/etc/dhcpcd/dhcpcd.conf</code> to apply fixes.</p>
  <h4 data-number="7.2.1.2" id="carrier-lost"><span
  class="header-section-number">7.2.1.2</span> Carrier Lost</h4>
  <p>If <code>dhcpcd</code> logs show messages like:</p>
  <pre><code>dhcpcd[852]: enp0s31f6: carrier lost</code></pre>
  <p>or</p>
  <pre><code>dhcpcd[852]: enp0s31f6: waiting for carrier
dhcpcd[852]: carrier acquired
dhcpcd[852]: soliciting an IPv6 router
dhcpcd[852]: no global addresses for default route
dhcpcd[852]: timed out</code></pre>
  <p>You may try adding the following options to
  <code>/etc/dhcpcd/dhcpcd.conf</code>:</p>
  <div class="sourceCode" id="cb205"><pre
  class="sourceCode sh"><code class="sourceCode bash"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="ex">nolink</span>   <span class="co"># Ignore carrier status messages (for buggy drivers)</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="ex">noipv6</span>   <span class="co"># Disable IPv6 router advertisements</span></span></code></pre></div>
  <h4 data-number="7.2.1.3" id="client-id-issues"><span
  class="header-section-number">7.2.1.3</span> Client ID Issues</h4>
  <p>If your DHCPv4 network filters Client IDs by MAC address,
  change:</p>
  <pre><code>duid</code></pre>
  <p>To:</p>
  <pre><code>clientid</code></pre>
  <p>This forces <code>dhcpcd</code> to use the hardware MAC address for
  DHCPv4, avoiding issues with RFC4361-style identifiers. See <a
  href="https://tools.ietf.org/html/rfc4361">RFC 4361</a> for
  details.</p>
  <h4 data-number="7.2.1.4" id="noncompliant-routers"><span
  class="header-section-number">7.2.1.4</span> Noncompliant Routers</h4>
  <p>Some routers reject requests unless you comment out:</p>
  <pre><code>require dhcp_server_identifier</code></pre>
  <p>This is safe unless you have multiple DHCP servers on the same
  network. See <a
  href="https://technet.microsoft.com/en-us/library/cc977442.aspx">Microsoft
  Technet</a> for background.</p>
  <h4 data-number="7.2.1.5" id="quick-summary"><span
  class="header-section-number">7.2.1.5</span> Quick Summary</h4>
  <ul>
  <li><p>Use <code>nolink</code> and <code>noipv6</code> to handle
  carrier loss.</p></li>
  <li><p>Switch from <code>duid</code> to <code>clientid</code> for
  DHCPv4 MAC-based networks.</p></li>
  <li><p>Comment out <code>require dhcp_server_identifier</code> for
  noncompliant routers.</p></li>
  </ul>
  <h2 data-number="7.3" id="appendix-c-frequently-asked-questions"><span
  class="header-section-number">7.3</span> Appendix C: Frequently Asked
  Questions</h2>
  <p>This appendix collects common questions about Zeppe‑Lin. Questions
  are grouped by topic for easier navigation.</p>
  <h3 data-number="7.3.1" id="general"><span
  class="header-section-number">7.3.1</span> General</h3>
  <h4 class="unnumbered"
  id="why-is-the-distribution-named-zeppe-lin">Why is the distribution
  named Zeppe-Lin?</h4>
  <p>The name is a deliberate nod to classic UNIX culture and the early
  era of Linux experimentation. It reflects the project’s appreciation
  for engineering craft, simplicity, and a certain irreverent
  independence.</p>
  <p>The name carries no technical meaning and should not be
  over-interpreted.</p>
  <p>Or, if you prefer, you can consider it our “Whole Lotta Love” for
  Linux and GNU — just renamed!</p>
  <h4 class="unnumbered"
  id="is-zeppe-lin-a-fork-of-another-distribution">Is Zeppe-Lin a fork
  of another distribution?</h4>
  <p>Yes. Zeppe‑Lin is a fork of <a href="https://crux.nu/">CRUX</a>, a
  lightweight, source‑based Linux distribution.</p>
  <p>It inherits CRUX’s minimalist philosophy and tooling, but evolves
  them independently, with its own design decisions and policies.</p>
  <h4 class="unnumbered"
  id="what-makes-zeppe-lin-different-from-crux-or-kiss-linux">What makes
  Zeppe-Lin different from CRUX or KISS Linux?</h4>
  <p>Zeppe-Lin focuses on <strong>practical minimalism</strong> rather
  than extreme reduction or strict preservation of legacy behavior.</p>
  <p>Compared to CRUX, Zeppe-Lin actively refactors core tooling instead
  of keeping it unchanged for compatibility’s sake. Package management,
  build utilities, and system tools are reorganized for clarity,
  consistency, and long-term maintainability.</p>
  <p>Compared to KISS Linux, Zeppe-Lin favors clear structure and
  explicit behavior over minimal code size. It is willing to use more
  capable implementations when they improve correctness, auditability,
  or usability.</p>
  <p>Across the system, Zeppe-Lin generally favors:</p>
  <ul>
  <li>POSIX-compliant sh(1p) instead of Bash</li>
  <li>Explicit configuration over implicit behavior</li>
  <li>Manual pages as a primary interface</li>
  <li>Removal of obsolete or redundant mechanisms</li>
  <li>Readable, structured implementations rather than ad-hoc
  scripts</li>
  </ul>
  <p>Zeppe-Lin does not aim to be the smallest possible system. It aims
  to remain understandable and controllable as it evolves.</p>
  <h4 class="unnumbered" id="is-zeppe-lin-suitable-for-beginners">Is
  Zeppe-Lin suitable for beginners?</h4>
  <p>No. Zeppe-Lin assumes prior Linux experience. Users are expected to
  be comfortable with the command line, manual configuration, and
  building software from source.</p>
  <p>It is not designed to be beginner-friendly, automated, or
  “hands-off”.</p>
  <h3 data-number="7.3.2" id="installation-1"><span
  class="header-section-number">7.3.2</span> Installation</h3>
  <h4 class="unnumbered"
  id="i-cant-find-the-zeppelin-installation-cddvd.-did-i-miss-something">I
  can’t find the Zeppe‑Lin installation CD/DVD. Did I miss
  something?</h4>
  <p>No installation media exists. Zeppe-Lin is installed using a
  minimal root filesystem tarball. Installation is performed from a live
  environment of your choice.</p>
  <h4 class="unnumbered" id="why-is-there-no-installer">Why is there no
  installer?</h4>
  <p>An installer would obscure system layout and behavior behind
  automation.</p>
  <p>Zeppe-Lin intentionally exposes system setup so users understand
  what is installed, how it is configured, and why it works. This
  approach aligns with the project’s emphasis on clarity and
  control.</p>
  <h3 data-number="7.3.3" id="configuration-1"><span
  class="header-section-number">7.3.3</span> Configuration</h3>
  <h4 class="unnumbered" id="does-zeppe-lin-use-systemd">Does Zeppe-Lin
  use systemd?</h4>
  <p>No. Zeppe-Lin uses a traditional, script-based init system.</p>
  <p>Service management is explicit and readable, and does not rely on a
  monolithic service manager.</p>
  <h3 data-number="7.3.4" id="packages-and-features"><span
  class="header-section-number">7.3.4</span> Packages and Features</h3>
  <h4 class="unnumbered"
  id="where-is-the-package-or-feature-i-need">Where is the package or
  feature I need?</h4>
  <p>Zeppe-Lin is community-driven. If a package or feature is missing,
  users are encouraged to add it.</p>
  <p>Follow the <code>packaging(7)</code> guidelines and submit a pull
  request to the appropriate repository.</p>
  <p>The system evolves through user contributions rather than
  centralized curation.</p>
  <h4 class="unnumbered"
  id="why-are-some-familiar-crux-tools-missing-or-replaced">Why are some
  familiar CRUX tools missing or replaced?</h4>
  <p>Some tools were removed or replaced because their original design
  goals no longer aligned with Zeppe-Lin’s direction.</p>
  <p>When this happens, replacements are chosen to be simpler, more
  explicit, or easier to maintain. Each major tool includes
  documentation explaining its design and differences.</p>
  <h3 data-number="7.3.5" id="maintenance"><span
  class="header-section-number">7.3.5</span> Maintenance</h3>
  <h4 class="unnumbered"
  id="how-often-does-zeppe-lin-release-new-versions">How often does
  Zeppe-Lin release new versions?</h4>
  <p>Zeppe-Lin follows a <strong>semi-rolling release
  model</strong>.</p>
  <p>The toolchain (compiler, libc, and related components) is kept
  stable for extended periods. Userland packages evolve on top of this
  stable base.</p>
  <p>When accumulated changes make the existing toolchain a limiting
  factor, the toolchain is updated, userland is rebuilt and polished,
  and a new <strong>major version</strong> is released.</p>
  <p>Between major releases, <strong>minor versions</strong> (e.g.,
  v1.1, v1.2) are published when enough non-toolchain changes accumulate
  to justify a new root filesystem.</p>
  <p>There is no fixed schedule. Releases happen when they are
  ready.</p>
  <h4 class="unnumbered" id="is-zeppe-lin-stable">Is Zeppe-Lin
  stable?</h4>
  <p>Zeppe-Lin prioritizes correctness and predictability over rapid
  change.</p>
  <p>While it is source-based and expects user involvement, care is
  taken to avoid unnecessary breakage, especially within a stable
  toolchain cycle.</p>
  <p>Important packaging changes, required manual interventions, and
  security updates are announced on the <a
  href="mailto:zeppe-lin@freelists.org"
  class="email">zeppe-lin@freelists.org</a> mailing list. Users are
  strongly encouraged to subscribe and follow these notices.</p>
  <h3 data-number="7.3.6" id="support-and-community"><span
  class="header-section-number">7.3.6</span> Support and Community</h3>
  <h4 class="unnumbered" id="how-can-i-report-bugs-or-issues">How can I
  report bugs or issues?</h4>
  <p>See <a href="#appendix-d-reporting-issues">Appendix D: Reporting
  Issues</a>. Report issues in the repository corresponding to the
  affected component (packages, tools, website, or artwork). Include
  version, logs, steps to reproduce, and any relevant local
  modifications.</p>
  <h4 class="unnumbered" id="can-i-contribute">Can I contribute?</h4>
  <p>Yes. Contributions can include:</p>
  <ul>
  <li>New packages or updates to existing ones</li>
  <li>Tool improvements or bug fixes</li>
  <li>Documentation enhancements</li>
  <li>Artwork or visual identity improvements</li>
  </ul>
  <p>Follow repository guidelines, and submit a pull request to the
  appropriate repository.</p>
  <h3 data-number="7.3.7" id="philosophy"><span
  class="header-section-number">7.3.7</span> Philosophy</h3>
  <h4 class="unnumbered"
  id="is-zeppe-lin-trying-to-compete-with-other-distributions">Is
  Zeppe-Lin trying to compete with other distributions?</h4>
  <p>No. Zeppe-Lin exists to satisfy its own design goals and the needs
  of its users.</p>
  <p>It does not aim to replace other distributions or appeal to a broad
  audience.</p>
  <h2 data-number="7.4" id="appendix-d-reporting-issues"><span
  class="header-section-number">7.4</span> Appendix D: Reporting
  Issues</h2>
  <p>This appendix explains how to report problems with Zeppe‑Lin.
  Clear, well-structured reports help the team respond efficiently.</p>
  <h3 data-number="7.4.1" id="where-to-report"><span
  class="header-section-number">7.4.1</span> Where to Report</h3>
  <p>Submit issues in the repository that corresponds to the type of
  problem:</p>
  <ul>
  <li><p><strong>Package-related problems</strong><br />
  Open an issue in the relevant <code>pkgsrc-*</code>
  repository.</p></li>
  <li><p><strong>Tool issues</strong><br />
  Report in the specific tool repository, e.g., <code>pkgman</code>,
  <code>pkgmk</code>, <code>pkgutils</code>, <code>rejmerge</code>,
  <code>revdep</code>.</p></li>
  <li><p><strong>Website or documentation</strong><br />
  Report in the <a
  href="https://github.com/zeppe-lin/zeppe-lin.github.io/"><code>zeppe-lin.github.io</code></a>
  repository.</p></li>
  <li><p><strong>Artwork or visual assets</strong><br />
  Report in the <a
  href="https://github.com/zeppe-lin/artwork/"><code>artwork</code></a>
  repository.</p></li>
  <li><p><strong>Upstream software bugs</strong><br />
  Report directly to the upstream project, not in Zeppe-Lin repos,
  unless it affects packaging.</p></li>
  </ul>
  <p>You can subscribe to or report via mailing list:</p>
  <ul>
  <li><p><strong>General user discussion / small issues:</strong>
  <code>zeppe-lin@freelists.org</code></p></li>
  <li><p><strong>Development, commits, tool updates:</strong>
  <code>zeppe-lin-dev@freelists.org</code></p></li>
  </ul>
  <h3 data-number="7.4.2" id="what-to-include"><span
  class="header-section-number">7.4.2</span> What to Include</h3>
  <p>Provide as much relevant information as possible:</p>
  <ul>
  <li>Zeppe-Lin version or snapshot</li>
  <li>Clear description of the problem</li>
  <li>Steps to reproduce</li>
  <li>Relevant error messages, logs, or outputs</li>
  <li>Local modifications that may affect behavior</li>
  </ul>
  <h3 data-number="7.4.3" id="reporting-guidelines"><span
  class="header-section-number">7.4.3</span> Reporting Guidelines</h3>
  <ul>
  <li>Verify that the issue is reproducible before reporting.</li>
  <li>Search existing issues to avoid duplicates.</li>
  <li>Keep reports factual, concise, and structured.</li>
  <li>Do <strong>not</strong> assume the cause unless you have
  evidence.</li>
  <li>Reference related issues, commits, or upstream bugs where
  applicable.</li>
  </ul>
  <blockquote>
  <p><strong>Tip:</strong></p>
  <p>Well-prepared reports get faster responses and make troubleshooting
  easier for both users and developers.</p>
  </blockquote>
</main>

</body>
</html>
